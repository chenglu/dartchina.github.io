<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Language" content="en_US" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Basics for command-line apps.">
  <title>Write Command-Line Apps | Dart</title>

  <!-- Favicon / Touch Icons -->
  <link rel="icon" sizes="64x64" href="/assets/shared/dart/icon/64.png">
  <link href="/assets/touch-icon-iphone.png" rel="apple-touch-icon">
  <link href="/assets/touch-icon-ipad.png" rel="apple-touch-icon" sizes="76x76">
  <link href="/assets/touch-icon-iphone-retina.png" rel="apple-touch-icon" sizes="120x120">
  <link href="/assets/touch-icon-ipad-retina.png" rel="apple-touch-icon" sizes="152x152">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@dart_lang" />
  <meta name="twitter:title" content="Write Command-Line Apps" />
  <meta name="twitter:description" content="Basics for command-line apps." />

  <!-- Open Graph -->
  <meta property="og:title" content="Write Command-Line Apps" />
  <meta property="og:description" content="Basics for command-line apps." />
  <meta property="og:url" content="https://www.dartlang.org/tutorials/dart-vm/cmdline" />
  <meta property="og:image" content="https://www.dartlang.org/assets/shared/dart-logo-for-shares.png?2" />

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,700' rel='stylesheet' type='text/css'>
  <link type="text/css" rel="stylesheet" href="/assets/style.css">
  
  <!--
    Why don't we use Dart here?

    The only scripting we use here is stuff like the on-click footnotes on the
    front page or resizing of the left nav. These happen to be use cases where
    JavaScript and jQuery are doing just fine. Dart is here for application
    programming, not page scripting.
   -->
  <script type="text/javascript" src="/assets/main.js"></script>
  
  <script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-26406144-4', 'auto');
ga('send', 'pageview');

</script>


</head>

  <body class="tutorial">
    <header id="page-header">
  <nav id="mainnav">
  <div id="menu-toggle"><i class="icon icon-menu"></i></div>
  <a href="/" class="brand" title="Dart">
    <img src="/assets/shared/dart/logo+text/horizontal/default.svg" alt="Dart">
  </a>
  <ul>
    <li class="mainnav__get-started"><a href="/guides/get-started"><span>入门</span></a></li>
    <li><a href="/guides/language">语言</a></li>
    <li><a href="/guides/libraries">库</a></li>
    <li><a href="/tools">工具</a></li>
    
    
    <li class="dropdown">
      <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dart 2 <span class="caret"></span></a>
      <ul class="dropdown-menu">
        

<li><a href="https://v1-dartlang-org.firebaseapp.com/tutorials/dart-vm/cmdline" class="no-automatic-external">1.24.3&nbsp;&nbsp;(archive)</a></li><li><a class="active">2.0.0-dev.66.0&nbsp;&nbsp;(beta)</a></li>

        <li role="separator" class="divider"></li>
        <li><a href="/dart-2#migration">迁移指南</a></li>
      </ul>
    </li>
    
    <li class="searchfield">
      <form class="navbar-search" action="/search" id="cse-search-box">
        <input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i">
        <input type="hidden" name="ie" value="UTF-8">
        <input type="hidden" name="hl" value="en">
        <input type="search" name="q" id="q" autocomplete="off" placeholder="Search">
        <button type="submit"><i class="icon icon-search"></i></button>
      </form>
    </li>
  </ul>
</nav>

  
</header>

    <main id="page-content">
      <div id="sidenav" class="">
  <div class="content">
    <a href="/" class="brand" title="Dart">
      <img src="/assets/shared/dart/logo+text/horizontal/default.svg" alt="Dart">
    </a>

    <div class="sidenav__search">
      <p>
        <a href="/search">Search <i class="icon icon-search"></i></a>
      </p>
    </div>

    <ul>
      <li>
        <a class="btn btn-default" href="/guides/get-started">入门</a>
      </li>
    </ul>
    <h4 ><a href="/guides/language" title="语言">语言</a></h4>
  <ul><li >
          <a href="/guides/language/language-tour" title="概览">概览</a>
        </li>
        
        <li >
          <a href="/guides/language/effective-dart" title="Effective Dart">Effective Dart</a>
          <i class="icon icon-arrow"></i>
          <ul><li >
                <a href="/guides/language/effective-dart/style" title="风格">风格</a>
              </li><li >
                <a href="/guides/language/effective-dart/documentation" title="文档">文档</a>
              </li><li >
                <a href="/guides/language/effective-dart/usage" title="使用">使用</a>
              </li><li >
                <a href="/guides/language/effective-dart/design" title="设计">设计</a>
              </li>
          </ul><li >
          <a href="/samples" title="示例代码">示例代码</a>
        </li>
  </ul><h4 ><a href="/guides/libraries" title="库">库</a></h4>
  <ul><li >
          <a href="/guides/libraries/library-tour" title="概览">概览</a>
        </li>
  </ul><h4 ><a href="/guides/platforms" title="平台">平台</a></h4>
  <ul><li >
          <a href="https://flutter.io" title="移动端 (Flutter)">移动端 (Flutter)</a>
        </li><li >
          <a href="https://webdev.dartlang.org" title="web">web</a>
        </li><li >
          <a href="/dart-vm" title="服务器">服务器</a>
        </li>
  </ul><h4 ><a href="/guides/testing" title="测试">测试</a></h4>
  <ul>
  </ul><h4 >资源</h4>
  <ul><li >
          <a href="/install" title="安装">安装</a>
        </li><li >
          <a href="/codelabs" title="Codelabs">Codelabs</a>
        </li><li class="active">
          <a href="/tutorials" title="学习指南">学习指南</a>
        </li><li >
          <a href="/articles" title="文章">文章</a>
        </li><li >
          <a href="/tools" title="工具">工具</a>
        </li><li >
          <a href="/community" title="社区支持">社区支持</a>
        </li>
  </ul>
  </div>
</div>

      
<div id="toc">
  <div class="content">
    <h4>On this page
      <a href="#page-content" title="Back to top" class="pull-right"><i class="icon icon-caret-up"></i></a>
    </h4>
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#an-introduction-to-standalone-apps">An introduction to standalone apps</a>
<ul>
<li class="toc-entry toc-h4"><a href="#whats-the-point">What's the point?</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#running-an-app-with-the-standalone-dart-vm">Running an app with the standalone Dart VM</a></li>
<li class="toc-entry toc-h2"><a href="#review-briefly-the-dcat-example-code">Review briefly the dcat example code</a></li>
<li class="toc-entry toc-h2"><a href="#parsing-command-line-arguments">Parsing command-line arguments</a></li>
<li class="toc-entry toc-h2"><a href="#reading-and-writing-with-stdin-stdout-and-stderr">Reading and writing with stdin, stdout, and stderr</a>
<ul>
<li class="toc-entry toc-h3"><a href="#stdout">stdout</a></li>
<li class="toc-entry toc-h3"><a href="#stderr">stderr</a></li>
<li class="toc-entry toc-h3"><a href="#stdin">stdin</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#getting-info-about-a-file">Getting info about a file</a></li>
<li class="toc-entry toc-h2"><a href="#reading-a-file">Reading a file</a></li>
<li class="toc-entry toc-h2"><a href="#writing-a-file">Writing a file</a></li>
<li class="toc-entry toc-h2"><a href="#getting-environment-information">Getting environment information</a></li>
<li class="toc-entry toc-h2"><a href="#setting-exit-codes">Setting exit codes</a></li>
<li class="toc-entry toc-h2"><a href="#summary">Summary</a></li>
<li class="toc-entry toc-h2"><a href="#other-resources">Other resources</a></li>
<li class="toc-entry toc-h2"><a href="#what-next">What next?</a></li>
</ul>
  </div>
</div>


      <article>
        <div class="content">
          
<div class="banner alert alert-info">
  <p class="banner__text">
    欢迎来到 <a href="/dart-2"><b>Dart 2</b></a>!
    如果您仍在使用 Dart 1.x? 可访问查阅
    <a href="https://v1-dartlang-org.firebaseapp.com" class="no-automatic-external" target="_blank" rel="noopener">存档站点</a>
    或 <a href="/dart-2#migration">迁移指南</a>.
  </p>
</div>


          
<nav id="subnav">
  <ul>
    <li class="previous">
      
        <a href="/tutorials/dart-vm/get-started">&lang;&nbsp;&nbsp;Get Started with the Dart VM</a>
      
    </li>
    <li class="next">
      
        <a href="/tutorials/dart-vm/httpserver">Write HTTP Clients & Servers&nbsp;&nbsp;&rang;</a>
      
    </li>
  </ul>
</nav>


          
          <div>
            <ul class="page-github-links-menu" role="group">
  <li>
    <a href="https://github.com/dart-lang/site-www/tree/master/src_zh_CN/_tutorials/dart-vm/cmdline.md"
      class="no-automatic-external"
      title="View page source"
      target="_blank" rel="noopener">
      <i class="fab fa-github fa-sm"></i>
    </a>
  </li>
  <li>
    <a href="https://github.com/dart-lang/site-www/issues/new?title='Write Command-Line Apps' page issue&body=From URL: https://www.dartlang.org/tutorials/dart-vm/cmdline"
      class="no-automatic-external"
      title="Report a bug on this page" target="_blank" rel="noopener">
      <i class="fas fa-bug fa-sm"></i>
    </a>
  </li>
</ul>

            <h1>Write Command-Line Apps</h1>
          </div>
          
<div class="banner alert alert-warning">
    <p class="banner__text">
      This tutorial has not yet been updated to Dart 2.
    </p>
</div>

<h3 id="an-introduction-to-standalone-apps">
<a id="an-introduction-to-standalone-apps" class="anchor" href="#an-introduction-to-standalone-apps" aria-hidden="true"><span class="octicon octicon-link"></span></a>An introduction to standalone apps</h3>

<div class="mini-toc">
  <h4>
<a id="whats-the-point" class="anchor" href="#whats-the-point" aria-hidden="true"><span class="octicon octicon-link"></span></a>What's the point?</h4>

  <ul>
    <li>Command-line applications need to do input and output.</li>
    <li>The dart:io library provides I/O functionality.</li>
    <li>The args package helps define and parse command-line arguments.</li>
    <li>The dart:async library supports asynchronous programming with Future and
Stream classes.</li>
    <li>A Future represents a value that will be available at some time in the future.</li>
    <li>Streams provide a series of asynchronous data events.</li>
    <li>Most input and output requires the use of Streams.</li>
  </ul>
</div>

<aside class="alert alert-info">
  <p><strong>Prerequisite:</strong>
This tutorial uses the <code class="highlighter-rouge">async</code> and <code class="highlighter-rouge">await</code> language features, which rely on the
<a href="https://api.dartlang.org/dev/dart-async/Future-class.html" target="_blank">Future</a>
and
<a href="https://api.dartlang.org/dev/dart-async/Stream-class.html" target="_blank">Stream</a> classes for asynchronous support.
Refer to <a href="/tutorials/language/futures">Asynchronous Programming: Futures</a>
and <a href="/tutorials/language/streams">Asynchronous Programming: Streams</a>
to learn more about these features.</p>
</aside>

<p>This tutorial teaches you how to build command-line apps
and shows you a few small command-line applications.
These programs use resources that most command-line applications need,
including the standard output, error, and input streams,
command-line arguments, files and directories, and more.</p>

<p>This tutorial uses the <code class="highlighter-rouge">dcat</code> example.
You can get it by
<a href="https://github.com/dart-lang/dart-tutorials-samples/archive/master.zip">downloading the tutorial examples</a>
from GitHub.</p>

<h2 id="running-an-app-with-the-standalone-dart-vm">
<a id="running-an-app-with-the-standalone-dart-vm" class="anchor" href="#running-an-app-with-the-standalone-dart-vm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running an app with the standalone Dart VM</h2>

<p>To run a command-line app, you need the Dart VM (<code class="highlighter-rouge">dart</code>),
which comes when you <a href="/tools/sdk#install">install the Dart SDK</a>.</p>

<p>The location of the SDK installation directory
(we’ll call it <em>&lt;sdk-install-dir&gt;</em>) depends on your platform
and how you installed the SDK.
You can find <code class="highlighter-rouge">dart</code> in <em>&lt;sdk-install-dir&gt;</em>/bin.
By putting this directory in your PATH
you can refer to the <code class="highlighter-rouge">dart</code> command and other commands, such as
<a href="https://github.com/dart-lang/sdk/tree/master/pkg/analyzer_cli#dartanalyzer">dartanalyzer</a>,
by name.</p>

<p>Let’s run a small program.</p>

<ol>
<li>
    <p>Create a file called <code class="highlighter-rouge">helloworld.dart</code> that contains this code:</p>

    <pre class="prettyprint lang-dart">
void main() {
  print('Hello, World!');
}
</pre>
  </li>

<li>
    <p>In the directory that contains the file you just created, run the program:</p>

    <div class="language-terminal highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="gp">$</span> dart helloworld.dart
<span class="go">Hello, World!
</span></code></pre></div>    </div>
  </li>
</ol>

<p>The Dart VM supports many options.
Use <code class="highlighter-rouge">dart --help</code> to see commonly used options.
Use <code class="highlighter-rouge">dart --verbose</code> to see all options.</p>

<h2 id="review-briefly-the-dcat-example-code">
<a id="review-briefly-the-dcat-example-code" class="anchor" href="#review-briefly-the-dcat-example-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Review briefly the dcat example code</h2>

<p>Take a quick look at the code for a small sample called <code class="highlighter-rouge">dcat</code>,
which displays the contents of any files listed on the command line.
This program uses various classes, functions, and properties
available to command-line apps.
This tutorial goes into detail about this app in the following sections.
For a brief look now, hover over the highlighted code below for explanations.</p>

<pre class="prettyprint lang-dart">
import 'dart:io';
import 'dart:convert';
<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Asynchronous library" data-content="The dart:async library defines Future and Stream classes.">import 'dart:async';</a>

import 'package:args/args.dart';

const lineNumber = 'line-number';

ArgResults argResults;

void main(<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Command-line arguments" data-content="Command-line arguments are passed in by the system when the program starts.">List&lt;String&gt; arguments</a>) {
  exitCode = 0; //presume success
  final parser = new ArgParser()
      ..addFlag(lineNumber, negatable: false, abbr: 'n');

  <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Arguments parser" data-content="The ArgParser class provides help with parsing command-line arguments.">argResults = parser.parse(arguments);</a>
  List&lt;String&gt; paths = argResults.rest;

  dcat(paths, argResults[lineNumber]);
}

Future dcat(List&lt;String&gt; paths, bool showLineNumbers) <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Asynchronous function" data-content='An asynchronous function is marked with "async" and returns a Future.'>async</a> {
  if (paths.isEmpty) {
    // No files provided as arguments. Read from stdin and print each line.
    <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Standard I/O streams" data-content="This line reads from the standard input stream and pipes the data to the standard output stream.">stdin.pipe(stdout);</a>
  } else {
    for (var path in paths) {
      int lineNumber = 1;
      <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Create a File object" data-content="Use the File class to represent the file on the native file system.">Stream lines = new File(path)</a>
          <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Open a file for reading" data-content="Read the content from the file asynchronously.">.openRead()</a>
          <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Data converters" data-content="Convert data as it becomes available on the stream.">.transform(utf8.decoder)</a>
          .transform(const LineSplitter());
      <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Exception handling" data-content='Function calls that might generate an exception are placed in a "try" block.'>try</a> {
        <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Get data from the stream" data-content='Use "await for" to loop over the values as they become available on the stream. The program pauses while waiting for the next line.'>await for (var line in lines)</a> {
          if (showLineNumbers) {
            stdout.write('${lineNumber++} ');
          }
          stdout.writeln(line);
        }
      } <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Exception handling" data-content='Any errors encountered in the stream are handled in the "catch" block.'>catch</a> (_) {
        _handleError(path);
      }
    }
  }
}

Future _handleError(String path) async {
  if (<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Test the path" data-content='You can get information about the file system on which your program is running. The "await" keyword causes error handling to pause until the path is available.'>await FileSystemEntity.isDirectory(path)</a>) {
    stderr.writeln('error: $path is a directory');
  } else {
    <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Exit code" data-content="A well-behaved command-line app sets an exit code to indicate whether the program was successful.">exitCode = 2;</a>
  }
}

</pre>

<h2 id="parsing-command-line-arguments">
<a id="parsing-command-line-arguments" class="anchor" href="#parsing-command-line-arguments" aria-hidden="true"><span class="octicon octicon-link"></span></a>Parsing command-line arguments</h2>

<p>The
<a href="https://pub.dartlang.org/packages/args" target="_blank">args</a>
package, a software bundle that contains a library of Dart code, provides
parser support for transforming raw command-line arguments
into a set of options, flags, and additional values.
Import the library as follows:</p>

<pre class="prettyprint lang-dart">
import 'package:args/args.dart';
</pre>

<p>The args library contains two classes:</p>

<table class="table">
  <thead>
    <tr>
      <th>Library</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://www.dartdocs.org/documentation/args/latest/args/ArgParser-class.html" target="_blank">ArgParser</a></td>
      <td>A class that parses command-line arguments</td>
    </tr>
    <tr>
      <td><a href="https://www.dartdocs.org/documentation/args/latest/args/ArgResults-class.html" target="_blank">ArgResults</a></td>
      <td>The result of parsing command-line arguments using ArgParser.</td>
    </tr>
  </tbody>
</table>

<p>Let’s take a look at the <code class="highlighter-rouge">dcat</code> sample,
which uses ArgParser and ArgResults to parse and store its command-line arguments.</p>

<ol>
<li>
    <p>Copy the sample file from the github repo:
<a href="https://raw.githubusercontent.com/dart-lang/dart-tutorials-samples/master/cmdline/bin/dcat.dart">dcat.dart</a>.</p>
  </li>

<li>
    <p>Run the program from the command line as shown by the <strong>boldface</strong> text.</p>

    <pre>
$ <b>dart dcat.dart -n quotes.txt</b>
1 Be yourself. Everyone else is taken. -Oscar Wilde
2 Don't cry because it's over, smile because it happened. -Dr. Seuss
3 You only live once, but if you do it right, once is enough. -Mae West
...
</pre>

    <p>The program displays the contents of the source code file and
preceeds each line with a line number.</p>
  </li>

</ol>

<p>The following diagram shows how the <code class="highlighter-rouge">dcat</code> command line used above
is parsed into the <code class="highlighter-rouge">ArgResults</code> object.</p>

<p><img src="images/commandlineargs.png" alt="ArgsParser parses command-line arguments"></p>

<p>You can access flags and options by name,
treating the ArgResults object like a Map.
You can access other values with properties such as <code class="highlighter-rouge">rest</code>.</p>

<p>Here’s the code from <code class="highlighter-rouge">dcat</code> that deals with command-line arguments:</p>

<pre class="prettyprint lang-dart">
...
<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Parsed arguments" data-content="This object contains parsed options and flags.">ArgResults argResults;</a>

void main(<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Command-line arguments" data-content="The system passes command-line arguments into the program in a list of strings.">List&lt;String&gt; arguments</a>) {
  exitCode = 0; //presume success
  final parser = new ArgParser()
    <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Define a valid flag" data-content="Add a flag definition to the command-line argument parser. This code defines the flag -n, which when used displays line numbers.">..addFlag(lineNumber, negatable: false, abbr: 'n')</a>;

  argResults = parser.<a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Parse the arguments" data-content="Parse the arguments that were passed into the main() function. The parser stops parsing if it finds an undefined option or flag.">parse(arguments)</a>;
  List&lt;String&gt; paths = <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Remaining arguments" data-content="To get the arguments that remain after parsing all of the valid options and flags, use the rest property.">argResults.rest</a>;

  dcat(paths, <a tabindex="0" role="button" class="highlight" data-toggle="popover" title="Refer to options and flags by name" data-content="You can refer to an option or flag by name treating the ArgResults object like a Map.">argResults[lineNumber])</a>;
}
...
</pre>

<p>The
<a href="https://www.dartdocs.org/documentation/args/latest/index.html" target="_blank">API docs</a>
for the args library
provide detailed information
to help you use ArgsParser and ArgResults classes.</p>

<h2 id="reading-and-writing-with-stdin-stdout-and-stderr">
<a id="reading-and-writing-with-stdin-stdout-and-stderr" class="anchor" href="#reading-and-writing-with-stdin-stdout-and-stderr" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reading and writing with stdin, stdout, and stderr</h2>

<p>Like other languages,
Dart has standard output, standard error, and standard input streams.
The standard I/O streams are defined at the top level of the dart:io library,</p>

<table class="table">
  <thead>
    <tr>
      <th>Stream</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stdout.html" target="_blank">stdout</a></td>
      <td>The standard output</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stderr.html" target="_blank">stderr</a></td>
      <td>The standard error</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stdin.html" target="_blank">stdin</a></td>
      <td>The standard input</td>
    </tr>
  </tbody>
</table>

<p>Import the dart:io and dart:async libraries as follows:</p>

<pre class="prettyprint lang-dart">
import 'dart:io';
import 'dart:async';
</pre>

<p>Only command-line applications, not web applications, can use the dart:io library.
The <code class="highlighter-rouge">async</code>, <code class="highlighter-rouge">await</code>, and <code class="highlighter-rouge">await for</code> keywords are built into the Dart language,
but you must import dart:async to refer to the Future or Stream class.</p>

<h3 id="stdout">
<a id="stdout" class="anchor" href="#stdout" aria-hidden="true"><span class="octicon octicon-link"></span></a>stdout</h3>

<p>Here’s the code from the <code class="highlighter-rouge">dcat</code> program that writes the line number to
the <code class="highlighter-rouge">stdout</code> (if the -n flag is set) followed by the line from the file.</p>

<pre class="prettyprint lang-dart">
if (showLineNumbers) {
  <span class="highlight">stdout.write('${lineNumber++} ');</span>
}

<span class="highlight">stdout.writeln(line);</span>
</pre>

<p>The <code class="highlighter-rouge">write()</code> and <code class="highlighter-rouge">writeln()</code> methods take an object of any type,
convert it to a string, and print it. The <code class="highlighter-rouge">writeln()</code> method
also prints a newline character.
<code class="highlighter-rouge">dcat</code> uses the <code class="highlighter-rouge">write()</code> method to print the line number so the
line number and the text appear on the same line.</p>

<p>You can also use the <code class="highlighter-rouge">writeAll()</code> method to print a list of objects,
or use <code class="highlighter-rouge">addStream()</code> to asynchronously print all of the elements from a stream.</p>

<p><code class="highlighter-rouge">stdout</code> provides more functionality than the <code class="highlighter-rouge">print()</code> function.
For example, you can display the contents of a stream with <code class="highlighter-rouge">stdout</code>.
However, you must use <code class="highlighter-rouge">print()</code> instead of <code class="highlighter-rouge">stdout</code>
for programs that are converted to and run in JavaScript.</p>

<h3 id="stderr">
<a id="stderr" class="anchor" href="#stderr" aria-hidden="true"><span class="octicon octicon-link"></span></a>stderr</h3>

<p>Use <code class="highlighter-rouge">stderr</code> to write error messages to the console.
The standard error stream has the same methods as <code class="highlighter-rouge">stdout</code>,
and you use it in the same way.
Although both <code class="highlighter-rouge">stdout</code> and <code class="highlighter-rouge">stderr</code> print to the console,
their output is separate
and can be redirected or piped at the command line
or programmatically to different destinations.</p>

<p>This code from <code class="highlighter-rouge">dcat</code> prints an error message if the user
tries to list a directory.</p>

<pre class="prettyprint lang-dart">
if (await FileSystemEntity.isDirectory(path)) {
  <span class="highlight">stderr.writeln('error: $path is a directory');</span>
} else {
  exitCode = 2;
}
</pre>

<h3 id="stdin">
<a id="stdin" class="anchor" href="#stdin" aria-hidden="true"><span class="octicon octicon-link"></span></a>stdin</h3>

<p>The standard input stream typically
reads data synchronously from the keyboard,
although it can read asynchronously
and it can get input piped in from the standard
output of another program.</p>

<p>Here’s a small program that reads a single line from <code class="highlighter-rouge">stdin</code>:</p>

<pre class="prettyprint lang-dart">
import 'dart:io';

void main() {
  stdout.writeln('Type something');
  String input = stdin.readLineSync();
  stdout.writeln('You typed: $input');
}
</pre>

<p>The <code class="highlighter-rouge">readLineSync()</code> method reads text from the standard input stream,
blocking until the user types in text and presses return.
This little program prints out the typed text.</p>

<p>In the <code class="highlighter-rouge">dcat</code> program,
if the user does not provide a filename on the command line,
the program instead reads synchronously from stdin
using the <code class="highlighter-rouge">pipe()</code> method.</p>

<pre class="prettyprint lang-dart">
<span class="highlight">stdin</span>.pipe(stdout);
</pre>

<p>In this case,
the user types in lines of text and the program copies them to stdout.
The user signals the end of input by typing &lt;ctl-d&gt;.</p>

<div class="language-terminal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> dart dcat.dart
<span class="go">The quick brown fox jumped over the lazy dog.
The quick brown fox jumped over the lazy dog.
</span></code></pre></div></div>

<h2 id="getting-info-about-a-file">
<a id="getting-info-about-a-file" class="anchor" href="#getting-info-about-a-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting info about a file</h2>

<p>The
<a href="https://api.dartlang.org/dev/dart-io/FileSystemEntity-class.html" target="_blank">FileSystemEntity</a>
class in the dart:io library provides properties and static methods
that help you inspect and manipulate the file system.</p>

<p>For example, if you have a path,
you can determine whether the path is a file, a directory, a link, or not found
by using the <code class="highlighter-rouge">type()</code> method from the <code class="highlighter-rouge">FileSystemEntity</code> class.
Because the <code class="highlighter-rouge">type()</code> method accesses the file system,
it performs the check asynchronously.</p>

<p>The following code from the <code class="highlighter-rouge">dcat</code> example uses <code class="highlighter-rouge">FileSystemEntity</code>
to determine if the path provided on the command line is a directory.
The Future returns a boolean that indicates if the path is a directory or not.
Because the check is asynchronous, the code calls <code class="highlighter-rouge">isDirectory()</code>
using <code class="highlighter-rouge">await</code>.</p>

<pre class="prettyprint lang-dart">
if (await <span class="highlight">FileSystemEntity.isDirectory(path)</span>) {
  stderr.writeln('error: $path is a directory');
} else {
  exitCode = 2;
}
</pre>

<p>Other interesting methods in the <code class="highlighter-rouge">FileSystemEntity</code> class
include <code class="highlighter-rouge">isFile()</code>, <code class="highlighter-rouge">exists()</code>, <code class="highlighter-rouge">stat()</code>, <code class="highlighter-rouge">delete()</code>,
and <code class="highlighter-rouge">rename()</code>, all of which also use a Future to return a value.</p>

<p>FileSystemEntity is the superclass for the File, Directory, and Link classes.</p>

<h2 id="reading-a-file">
<a id="reading-a-file" class="anchor" href="#reading-a-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reading a file</h2>

<p><code class="highlighter-rouge">dcat</code> opens each file listed on the command line
with the <code class="highlighter-rouge">openRead()</code> method, which returns a stream.
The <code class="highlighter-rouge">await for</code> block waits for the file to be read
asynchronously. The data prints to stdout when it
becomes available on the stream.</p>

<pre class="prettyprint lang-dart">
for (var path in paths) {
  int lineNumber = 1;
  Stream lines = new File(path)
      .openRead()
      .transform(utf8.decoder)
      .transform(const LineSplitter());
  try {
    <span class="highlight">await for (var line in lines) {</span>
      <span class="highlight">if (showLineNumbers) {</span>
        <span class="highlight">stdout.write('${lineNumber++} ');</span>
      <span class="highlight">}</span>
      <span class="highlight">stdout.writeln(line);</span>
    }
  } catch (_) {
    _handleError(path);
  }
}
</pre>

<p>The following shows the rest of the code, which uses two decoders that
transform the data before making it available in the <code class="highlighter-rouge">await for</code> block.
The UTF8 decoder converts the data into Dart strings.
<code class="highlighter-rouge">LineSplitter</code> splits the data at newlines.</p>

<pre class="prettyprint lang-dart">
for (var path in paths) {
  int lineNumber = 1;
  Stream lines = new File(path)
      .openRead()
      <span class="highlight">.transform(utf8.decoder)</span>
      <span class="highlight">.transform(const LineSplitter());</span>
  try {
    await for (var line in lines) {
      if (showLineNumbers) {
        stdout.write('${lineNumber++} ');
      }
      stdout.writeln(line);
    }
  } catch (_) {
    _handleError(path);
  }
}
</pre>

<p>The dart:convert library contains these and other data converters,
including one for JSON.
To use these converters you need to import the dart:convert library:</p>

<pre class="prettyprint lang-dart">
import 'dart:convert';
</pre>

<h2 id="writing-a-file">
<a id="writing-a-file" class="anchor" href="#writing-a-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Writing a file</h2>

<p>The easiest way to write text to a file is to create a
<a href="https://api.dartlang.org/dev/dart-io/File-class.html" target="_blank">File</a>
object and use the <code class="highlighter-rouge">writeAsString()</code> method:</p>

<pre class="prettyprint lang-dart">
File quotesFile = new File('quotes.txt');
String stronger = 'That which does not kill us makes us stronger. -Nietzsche';

try {
  await quotesFile.writeAsString(stronger, mode: FileMode.append);
  print('Data written.');
} catch (e) {
  print('Oops!');
}
</pre>

<p>The <code class="highlighter-rouge">writeAsString()</code> method writes the data asynchronously.
It opens the file before writing and closes the file when done.
To append data to an existing file, you can use the optional
parameter <code class="highlighter-rouge">mode</code> and set its value to <code class="highlighter-rouge">FileMode.append</code>.
Otherwise, the mode is <code class="highlighter-rouge">FileMode.write</code> and the previous contents of the file,
if any, are overwritten.</p>

<p>If you want to write more data, you can open the file for writing.
The <code class="highlighter-rouge">openWrite()</code> method returns an IOSink (the same type as stdin and stderr).
You can continue to write to the file until done,
at which time, you must close the file.
The <code class="highlighter-rouge">close()</code> method is asynchronous and returns a Future.</p>

<pre class="prettyprint lang-dart">
IOSink quotes = new File('quotes.txt').openWrite(mode: FileMode.append);

quotes.write('A woman is like a tea bag; ');
quotes.write('you never know how strong it is until it\'s in hot water.');
quotes.writeln(' -Eleanor Roosevelt');
await quotes.close();
print('Done!');
</pre>

<h2 id="getting-environment-information">
<a id="getting-environment-information" class="anchor" href="#getting-environment-information" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting environment information</h2>

<p>Use the
<a href="https://api.dartlang.org/dev/dart-io/Platform-class.html" target="_blank">Platform</a>
class
to get information about the machine and OS that the program is running on.
Note: Use the Platform class from the dart:io library,
not from the dart:html library.</p>

<p><code class="highlighter-rouge">Platform.environment</code> provides a copy of the environment
variables in an immutable map. If you need a mutable map (modifiable copy) you
can use <code class="highlighter-rouge">Map.from(Platform.environment)</code>.</p>

<pre class="prettyprint lang-dart">
Map environmentVars = Platform.environment;

print('PWD = ${environmentVars["PWD"]}');
print('LOGNAME = ${environmentVars["LOGNAME"]}');
print('PATH = ${environmentVars["PATH"]}');
</pre>

<p><code class="highlighter-rouge">Platform</code> provides other useful properties that give
information about the machine, OS, and currently
running program.
For example:</p>

<ul>
  <li><code class="highlighter-rouge">Platform.isMacOS()</code></li>
  <li><code class="highlighter-rouge">Platform.numberOfProcessors</code></li>
  <li><code class="highlighter-rouge">Platform.script.path</code></li>
</ul>

<h2 id="setting-exit-codes">
<a id="setting-exit-codes" class="anchor" href="#setting-exit-codes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting exit codes</h2>

<p>The dart:io library defines a top-level property,
<code class="highlighter-rouge">exitCode</code>, that you can change to set the exit code for
the current invocation of the Dart VM.
An exit code is a number passed from
the Dart program to the parent process
to indicate the success, failure, or other state of the
execution of the program.</p>

<p>The <code class="highlighter-rouge">dcat</code> program sets the exit code
in the <code class="highlighter-rouge">_handleError()</code> function to indicate that an error
occcurred during execution.</p>

<pre class="prettyprint lang-dart">
Future _handleError(String path) async {
  if (await FileSystemEntity.isDirectory(path)) {
    stderr.writeln('error: $path is a directory');
  } else {
    <span class="highlight">exitCode = 2;</span>
  }
}
</pre>

<p>An exit code of 2 indicates that the program encountered an error.</p>

<p>An alternative to using <code class="highlighter-rouge">exitCode</code> is to use the top-level <code class="highlighter-rouge">exit()</code> function,
which sets the exit code and quits the program immediately.
For example, the <code class="highlighter-rouge">_handleError()</code> function could call <code class="highlighter-rouge">exit(2)</code>
instead of setting <code class="highlighter-rouge">exitCode</code> to 2,
but <code class="highlighter-rouge">exit()</code> would quit the program
and it might not process all of the files on the command line.</p>

<aside class="alert alert-info">
  <p>Generally speaking, you are better off using the <code class="highlighter-rouge">exitCode</code> property,
which sets the exit code but allows the program to continue through to its
natural completion.</p>
</aside>

<p>Although you can use any number for an exit code,
by convention, the codes in the table below have the following meanings:</p>

<table class="table">
  <thead>
    <tr>
      <th>Code</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Success</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Warnings</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Errors</td>
    </tr>
  </tbody>
</table>

<h2 id="summary">
<a id="summary" class="anchor" href="#summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary</h2>

<p>This tutorial described some basic API found in these classes from the dart:io library:</p>

<table class="table">
  <thead>
    <tr>
      <th>API</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/IOSink-class.html" target="_blank">IOSink</a></td>
      <td>Helper class for objects that consume data from streams.</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/File-class.html" target="_blank">File</a></td>
      <td>Represents a file on the native file system</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/Directory-class.html" target="_blank">Directory</a></td>
      <td>Represents a directory on the native file system</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/FileSystemEntity-class.html" target="_blank">FileSystemEntity</a></td>
      <td>Superclass for File and Directory</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/Platform-class.html" target="_blank">Platform</a></td>
      <td>Provides information about the machine and operating system</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stdout.html" target="_blank">stdout</a></td>
      <td>The standard output</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stderr.html" target="_blank">stderr</a></td>
      <td>The standard error</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/stdin.html" target="_blank">stdin</a></td>
      <td>The standard input</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/exitCode.html" target="_blank">exitCode</a></td>
      <td>Sets the exit code</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dev/dart-io/exit.html" target="_blank">exit()</a></td>
      <td>Sets the exit code and quits</td>
    </tr>
  </tbody>
</table>

<p>In addition, this tutorial covers two classes that help with command-line arguments:</p>

<table class="table">
  <thead>
    <tr>
      <th>Class</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://www.dartdocs.org/documentation/args/latest/args/ArgParser-class.html" target="_blank">ArgParser</a></td>
      <td>A class that transforms a list of raw arguments and into a set of options, flags, and remaining values.</td>
    </tr>
    <tr>
      <td><a href="https://www.dartdocs.org/documentation/args/latest/args/ArgResults-class.html" target="_blank">ArgResults</a></td>
      <td>The result of parsing raw command line arguments using ArgParser.</td>
    </tr>
  </tbody>
</table>

<h2 id="other-resources">
<a id="other-resources" class="anchor" href="#other-resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Other resources</h2>

<p>Check out the <a href="https://dart-lang.github.io/server/">Servers with Dart</a>
to find more resources related to writing command-line apps.</p>

<p>Refer to the API docs for
<a href="https://api.dartlang.org/dev/dart-io/dart-io-library.html" target="_blank">dart:io</a>,
<a href="https://api.dartlang.org/dev/dart-async/dart-async-library.html" target="_blank">dart:async</a>,
<a href="https://api.dartlang.org/dev/dart-convert/dart-convert-library.html" target="_blank">dart:convert</a>,
and the
<a href="https://www.dartdocs.org/documentation/args/latest/index.html" target="_blank">args</a>
package for more classes, functions, and properties.</p>

<h2 id="what-next">
<a id="what-next" class="anchor" href="#what-next" aria-hidden="true"><span class="octicon octicon-link"></span></a>What next?</h2>

<ul>
  <li>If you are interested in server-side programming,
check out the next tutorial,
<a href="/tutorials/dart-vm/httpserver">Write HTTP Clients &amp; Servers</a>.</li>
</ul>




          
<nav id="subnav">
  <ul>
    <li class="previous">
      
        <a href="/tutorials/dart-vm/get-started">&lang;&nbsp;&nbsp;Get Started with the Dart VM</a>
      
    </li>
    <li class="next">
      
        <a href="/tutorials/dart-vm/httpserver">Write HTTP Clients & Servers&nbsp;&nbsp;&rang;</a>
      
    </li>
  </ul>
</nav>


        </div>
      </article>
    </main>
    <footer id="page-footer">
  <div class="container">
    <div class="row">
      <div class="col-sm-12 col-md-3">
        <div class="content">
          <div class="brand">
            <img src="/assets/shared/dart/logo+text/horizontal/mono.svg" alt="Dart logo" class="brand"/>
          </div>
          <h4><a href="/terms">Terms</a> | <a href="https://policies.google.com/privacy">Privacy</a></h4>
          <style>.menu .material-icons { font-size: 14px; }</style><ul class="menu">
            <li>Site&nbsp;<a href="http://creativecommons.org/licenses/by/3.0/" class="no-automatic-external">CC&nbsp;BY&nbsp;3.0</a></li>
            <li>
              <a href="https://github.com/dart-lang/site-www"
                 title="This site's source is on GitHub."
                 class="no-automatic-external"><i class="fab fa-github fa-sm"></i></a>
              &nbsp;
              <a href="https://github.com/dart-lang/site-www/issues"
                 title="File an issue about this site."
                 class="no-automatic-external"><i class="fas fa-bug fa-sm"></i></a>
              &nbsp;
              <a 
                 title="Site built on 2018/07/11 19:44 CST"
                 
                 class="no-automatic-external"><i class="material-icons">build</i></a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-sm-4 col-md-3">
        <div class="content">
          <h4>技术</h4>
          <ul>
            <li><a href="https://flutter.io">Dart 移动开发 (Flutter)</a></li>
            <li><a href="https://webdev.dartlang.org">Dart web 开发</a></li>
            <li><a href="/dart-vm">Dart 服务器开发</a></li>
            <li><a href="https://dart-lang.github.io/observatory/">Observatory 工具</a></li>
            <li><a href="/guides/libraries">Dart 库</a></li>
            <li><a href="/guides/language">Dart 编程语言</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-4 col-md-3">
        <div class="content">
          <h4>资源</h4>
          <ul>
            <li><a href="https://api.dartlang.org/dev">API 参考</a></li>
            <li><a href="https://dartpad.dartlang.org/">DartPad</a></li>
            <li><a href="https://pub.dartlang.org/">Pub packages</a></li>
            <li><a href="http://news.dartlang.org/">Dart 新闻</a></li>
            <li><a href="https://github.com/dart-lang/sdk/issues">Dart bugs 和 <br> 新需求</a></li>
          </ul>
        </div>
      </div>

      <div class="col-sm-4 col-md-3">
        <div class="content">
          <h4>社区</h4>
          <ul>
            <li><a href="/community">支持和邮件列表</a></li>
            <li><a href="/community/who-uses-dart">谁在用Dart</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/dart">Stack Overflow</a></li>
            <li>G+ <a href="https://plus.google.com/communities/114566943291919232850">社区</a> &
                <a href="https://plus.google.com/b/109866369054280216564/+dartlang">公告组</a></li>
            <li><a href="https://gitter.im/dart-lang/home">Gitter聊天室</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

  </body>
</html>
