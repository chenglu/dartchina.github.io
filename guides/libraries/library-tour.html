<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Language" content="en_US" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Learn about the major features in Dart's libraries.">
  <title>Dart 库概览 | Dart</title>

  <!-- Favicon / Touch Icons -->
  <link rel="icon" sizes="64x64" href="/assets/shared/dart/icon/64.png">
  <link href="/assets/touch-icon-iphone-a46c306c4fbfae0b28d63f512b01d7cb2ccf1e4ca9d7f3aab15ba1170beed4a0.png" rel="apple-touch-icon">
  <link href="/assets/touch-icon-ipad-d0181720760b3912858b6d40da1d5586b1e92c7c8656a485ea41005674401e6b.png" rel="apple-touch-icon" sizes="76x76">
  <link href="/assets/touch-icon-iphone-retina-3d9821a631425376ac6203dea3c23c1940ab7b5c506a25406662fab76cee2e0b.png" rel="apple-touch-icon" sizes="120x120">
  <link href="/assets/touch-icon-ipad-retina-b9715401952522f1daee2b4a4064a1bbfb5ffab78d0a47a7226dc87444d51c32.png" rel="apple-touch-icon" sizes="152x152">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@dart_lang" />
  <meta name="twitter:title" content="Dart 库概览" />
  <meta name="twitter:description" content="Learn about the major features in Dart's libraries." />

  <!-- Open Graph -->
  <meta property="og:title" content="Dart 库概览" />
  <meta property="og:description" content="Learn about the major features in Dart's libraries." />
  <meta property="og:url" content="https://www.dartlang.org/guides/libraries/library-tour" />
  <meta property="og:image" content="https://www.dartlang.org/assets/shared/dart-logo-for-shares.png?2" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" integrity="sha256-EULh7n7c0RZiOHiikIAEzXBQ0AXvb71Ul6a85V4AuTc=" crossorigin="anonymous" href="/assets/main-1142e1ee7edcd116623878a2908004cd7050d005ef6fbd5497a6bce55e00b937.css">
  <script src="/assets/main-8306ad9c5a7b0d639cab54fda750f6ae0b3fb8f964457c69a7ef962a0cc52902.js" integrity="sha256-gwatnFp7DWOcq1T9p1D2rgs/uPlkRXxpp++WKgzFKQI=" crossorigin="anonymous" type="text/javascript"></script>
  <script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-26406144-4', 'auto');
ga('send', 'pageview');

</script>


</head>

  <body class="default">
    <header id="page-header">
  <nav id="mainnav">
  <div id="menu-toggle"><i class="icon icon-menu"></i></div>
  <a href="/" class="brand" title="Dart">
    <img src="/assets/shared/dart/logo+text/horizontal/default-363c9c133ffb7780463d3d638632b64cc8221d74d93cd1002fb1efbbe9983bc9.svg" alt="Dart">
  </a>
  <ul>
    <li class="mainnav__get-started"><a href="/guides/get-started"><span>入门</span></a></li>
    <li><a href="/guides/language">语言</a></li>
    <li><a href="/guides/libraries">库</a></li>
    <li><a href="/tools">工具</a></li>
    
    
    <li class="dropdown">
      <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dart 2</a>
      <ul class="dropdown-menu">
        

<li><a href="https://v1-dartlang-org.firebaseapp.com/guides/libraries/library-tour" class="dropdown-item no-automatic-external">1.24.3&nbsp;&nbsp;(archive)</a></li><li><a class="active dropdown-item">2.1.0&nbsp;&nbsp;(stable)</a></li>

        <li role="separator" class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="/dart-2#migration">迁移指南</a></li>
      </ul>
    </li>
    
    <li class="searchfield">
      <form class="navbar-search" action="/search" id="cse-search-box">
        <input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i">
        <input type="hidden" name="ie" value="UTF-8">
        <input type="hidden" name="hl" value="en">
        <input type="search" name="q" id="q" autocomplete="off" placeholder="Search">
        <button type="submit"><i class="icon icon-search"></i></button>
      </form>
    </li>
  </ul>
</nav>

  
</header>

    <main id="page-content">
      <div id="sidenav" class="">
  <div class="content">
    <a href="/" class="brand" title="Dart">
      <img src="/assets/shared/dart/logo+text/horizontal/default-363c9c133ffb7780463d3d638632b64cc8221d74d93cd1002fb1efbbe9983bc9.svg" alt="Dart">
    </a>

    <div class="sidenav__search">
      <p>
        <a href="/search">Search <i class="icon icon-search"></i></a>
      </p>
    </div>

    <ul>
      <li>
        <a class="btn btn-light" href="/guides/get-started">入门</a>
      </li>
    </ul>
    <h4 ><a href="/guides/language" title="语言">语言</a></h4>
  <ul><li >
          <a href="/guides/language/language-tour" title="概览">概览</a>
        </li>
        
        <li >
          <a href="/guides/language/effective-dart" title="Effective Dart">Effective Dart</a>
          <i class="icon icon-arrow"></i>
          <ul><li >
                <a href="/guides/language/effective-dart/style" title="风格">风格</a>
              </li><li >
                <a href="/guides/language/effective-dart/documentation" title="文档">文档</a>
              </li><li >
                <a href="/guides/language/effective-dart/usage" title="使用">使用</a>
              </li><li >
                <a href="/guides/language/effective-dart/design" title="设计">设计</a>
              </li>
          </ul><li >
          <a href="/samples" title="示例代码">示例代码</a>
        </li>
  </ul><h4 ><a href="/guides/libraries" title="库">库</a></h4>
  <ul><li class="active">
          <a href="/guides/libraries/library-tour" title="概览">概览</a>
        </li>
  </ul><h4 ><a href="/guides/platforms" title="平台">平台</a></h4>
  <ul><li >
          <a href="https://flutterchina.club" title="移动端 (Flutter中文网)">移动端 (Flutter中文网)</a>
        </li><li >
          <a href="https://webdev.dartlang.org" title="Web">Web</a>
        </li><li >
          <a href="/server" title="服务器">服务器</a>
        </li>
  </ul><h4 ><a href="/guides/testing" title="测试">测试</a></h4>
  <ul>
  </ul><h4 >资源</h4>
  <ul><li >
          <a href="/install" title="安装">安装</a>
        </li><li >
          <a href="/codelabs" title="Codelab">Codelab</a>
        </li><li >
          <a href="/tutorials" title="学习指南">学习指南</a>
        </li><li >
          <a href="/tools" title="工具">工具</a>
        </li><li >
          <a href="/community" title="社区支持">社区支持</a>
        </li>
  </ul>
  </div>
</div>

      
<div id="toc">
  <div class="content">
    <header class="h4 text-uppercase">
      目录
      <a title="Back to top" class="back-to-top float-right mr-3">
        <i class="fas fa-angle-up"></i>
      </a>
    </header>
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#dartcore---数字集合字符串等">dart:core - 数字，集合，字符串等</a>
<ul>
<li class="toc-entry toc-h3"><a href="#控制台打印">控制台打印</a></li>
<li class="toc-entry toc-h3"><a href="#数字">数字</a></li>
<li class="toc-entry toc-h3"><a href="#字符和正则表达式">字符和正则表达式</a></li>
<li class="toc-entry toc-h3"><a href="#集合">集合</a></li>
<li class="toc-entry toc-h3"><a href="#uri">URI</a></li>
<li class="toc-entry toc-h3"><a href="#日期和时间">日期和时间</a></li>
<li class="toc-entry toc-h3"><a href="#工具类">工具类</a></li>
<li class="toc-entry toc-h3"><a href="#异常">异常</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#dartasync---异步编程">dart:async - 异步编程</a>
<ul>
<li class="toc-entry toc-h3"><a href="#future">Future</a></li>
<li class="toc-entry toc-h3"><a href="#stream">Stream</a></li>
<li class="toc-entry toc-h3"><a href="#更多内容">更多内容</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#dartmath---数学和随机数">dart:math - 数学和随机数</a>
<ul>
<li class="toc-entry toc-h3"><a href="#三角函数">三角函数</a></li>
<li class="toc-entry toc-h3"><a href="#最大值和最小值">最大值和最小值</a></li>
<li class="toc-entry toc-h3"><a href="#数学常数">数学常数</a></li>
<li class="toc-entry toc-h3"><a href="#随机数">随机数</a></li>
<li class="toc-entry toc-h3"><a href="#更多内容-1">更多内容</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#dartconvert---编解码jsonutf-8等">dart:convert - 编解码JSON，UTF-8等</a>
<ul>
<li class="toc-entry toc-h3"><a href="#编解码json">编解码JSON</a></li>
<li class="toc-entry toc-h3"><a href="#编解码-utf-8-字符">编解码 UTF-8 字符</a></li>
<li class="toc-entry toc-h3"><a href="#其他功能">其他功能</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#总结">总结</a></li>
</ul>
  </div>
</div>


      <article>
        <div class="content">
           <div class="banner alert alert-info">
  <p class="banner__text">
    
    
    Dart 2.1 现发布，具有更高的性能和可用性。
    <a href="https://medium.com/dartlang/announcing-dart-2-1-improved-performance-usability-9f55fca6f31a">了解更多。</a>
  </p>
</div>
 
          

          <div>
            <div id="page-github-links" class="btn-group" aria-label="Page GitHub links" role="group">
  <a href="https://github.com/dartchina/site-www-cn/tree/src_zh_CN/src_zh_CN/_guides/libraries/library-tour.md" class="btn no-automatic-external" title="View page source" target="_blank" rel="noopener">
    <i class="fas fa-file-alt fa-sm"></i>
  </a>
  <a href="https://github.com/dartchina/site-www-cn/issues/new?title='Dart 库概览' page issue&body=
Page URL: https://www.dartlang.org/guides/libraries/library-tour%0D%0A
Page source: https://github.com/dartchina/site-www-cn/tree/src_zh_CN/src_zh_CN/_guides/libraries/library-tour.md%0D%0A
%0D%0A
<!-- ADD YOUR DESCRIPTION OF THE PAGE ISSUE HERE: -->" class="btn no-automatic-external" title="Report a issue with this page"
    target="_blank" rel="noopener">
    <i class="fas fa-bug fa-sm"></i>
  </a>
</div>

            <h1>Dart 库概览</h1>
          </div>
          <?code-excerpt plaster="none"?>

<p>本章将介绍以下库的主要功能及使用方式，
所有Dart平台中都包含这些库：</p>

<dl>
  <dt><a href="#dartcore---numbers-collections-strings-and-more">dart:core</a></dt>
  <dd>内置类型，集合和其他核心功能。 
该库会被自动导入到所有的 Dart 程序。</dd>
  <dt><a href="#dartasync---asynchronous-programming">dart:async</a></dt>
  <dd>支持异步编程，包括Future和Stream等类。</dd>
  <dt><a href="#dartmath---math-and-random">dart:math</a></dt>
  <dd>数学常数和函数，以及随机数生成器。</dd>
  <dt><a href="#dartconvert---decoding-and-encoding-json-utf-8-and-more">dart:convert</a></dt>
  <dd>用于在不同数据表示之间进行转换的编码器和解码器，包括 JSON 和 UTF-8 。</dd>
</dl>

<p>本章只是一个概述；
只涵盖了几个 dart:* 库，
不包括第三方库。
特定平台库 dart:io 和 dart:html
的介绍，详见 <a href="/server/io-library-tour">dart:io tour</a> 和 <a href="https://webdev.dartlang.org/guides/html-library-tour">dart:html tour</a> 。</p>

<p>更多库信息可以在
<a href="https://pub.dartlang.org">pub.dartlang.org</a> 和
<a href="https://webdev.dartlang.org/guides/web-programming">Dart web developer library guide.</a> 查找。
所有 dart:* 库的 API 文档可以在
<a href="https://api.dartlang.org/stable">Dart API reference</a> 查找， 如果使用的是 Flutter
可以在 <a href="https://docs.flutter.io/">Flutter API reference.</a> 查找。</p>

<aside class="alert alert-info">
  <p><strong>DartPad tip：</strong> 可以通过将该页中的代码拷贝到 <a href="https://dartpad.dartlang.org">DartPad</a> 中进行演示。</p>
</aside>

<h2 id="dartcore---数字集合字符串等">
<a id="dartcore---数字集合字符串等" class="anchor" href="#dartcore---%E6%95%B0%E5%AD%97%E9%9B%86%E5%90%88%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%AD%89" aria-hidden="true"><span class="octicon octicon-link"></span></a>dart:core - 数字，集合，字符串等</h2>

<p>dart:core 库 (<a href="https://api.dartlang.org/stable/dart-core/dart-core-library.html">API reference</a>)
提供了一个少量但是重要的内置功能集合。
该库会被自动导入每个 Dart 程序。</p>

<h3 id="控制台打印">
<a id="控制台打印" class="anchor" href="#%E6%8E%A7%E5%88%B6%E5%8F%B0%E6%89%93%E5%8D%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>控制台打印</h3>

<p>顶级 <code class="highlighter-rouge">print()</code> 方法接受一个参数 任意对象）
并输出显示这个对象的字符串值(由 <code class="highlighter-rouge">toString()</code> 返回) 
到控制台。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (print)"?>
<pre class="prettyprint lang-dart">print(anObject);
print('I drink $tea.');</pre>

<p>有关基本字符串和 <code class="highlighter-rouge">toString()</code> 的更多信息，参考
<a href="/guides/language/language-tour#strings">Strings</a> in the language tour.</p>

<h3 id="数字">
<a id="数字" class="anchor" href="#%E6%95%B0%E5%AD%97" aria-hidden="true"><span class="octicon octicon-link"></span></a>数字</h3>

<p>dart:core 库定义了 num ，int 以及 double 类，
这些类拥有一定的工具方法来处理数字。</p>

<p>使用 int 和 double 的 <code class="highlighter-rouge">parse()</code> 方法将字符串转换为整型或双浮点型对象：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (int|double.parse)"?>
<pre class="prettyprint lang-dart">assert(int.parse('42') == 42);
assert(int.parse('0x42') == 66);
assert(double.parse('0.50') == 0.5);</pre>

<p>或者使用 num 的 parse() 方法，该方法可能会创建一个整型，否则为浮点型对象：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (num-parse)"?>
<pre class="prettyprint lang-dart">assert(num.parse('42') is int);
assert(num.parse('0x42') is int);
assert(num.parse('0.50') is double);</pre>

<p>通过添加 <code class="highlighter-rouge">radix</code> 参数，指定整数的进制基数：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (radix)"?>
<pre class="prettyprint lang-dart">assert(int.parse('42', radix: 16) == 66);</pre>

<p>使用 <code class="highlighter-rouge">toString()</code> 方法将整型或双精度浮点类型转换为字符串类型。
使用 <a href="https://api.dartlang.org/stable/dart-core/num/toStringAsFixed.html">toStringAsFixed().</a> 指定小数点右边的位数，
使用 <a href="https://api.dartlang.org/stable/dart-core/num/toStringAsPrecision.html">toStringAsPrecision():</a> 指定字符串中的有效数字的位数。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (toString())"?>
<pre class="prettyprint lang-dart">// 整型转换为字符串类型。
assert(42.toString() == '42');

// 双浮点型转换为字符串类型。
assert(123.456.toString() == '123.456');

// 指定小数点后的位数。
assert(123.456.toStringAsFixed(2) == '123.46');

// 指定有效数字的位数。
assert(123.456.toStringAsPrecision(2) == '1.2e+2');
assert(double.parse('1.2e+2') == 120.0);</pre>

<p>更多详情， 参考
<a href="https://api.dartlang.org/stable/dart-core/int-class.html">int，</a> <a href="https://api.dartlang.org/stable/dart-core/double-class.html">double，</a> 和 <a href="https://api.dartlang.org/stable/dart-core/num-class.html">num</a> 的相关 API 文档。
也可参考 <a href="#dartmath---math-and-random">dart:math section</a>。</p>

<h3 id="字符和正则表达式">
<a id="字符和正则表达式" class="anchor" href="#%E5%AD%97%E7%AC%A6%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>字符和正则表达式</h3>

<p>在 Dart 中一个字符串是一个固定不变的 UTF-16 编码单元序列。
语言概览中有更多关于 <a href="/guides/language/language-tour#strings">strings</a> 的内容。
使用正则表达式 (RegExp 对象) 可以在字符串内搜索和替换部分字符串。</p>

<p>String 定义了例如 <code class="highlighter-rouge">split()</code>， <code class="highlighter-rouge">contains()</code>，
<code class="highlighter-rouge">startsWith()</code>， <code class="highlighter-rouge">endsWith()</code> 等方法。</p>

<h4 id="在字符串中搜索">在字符串中搜索</h4>

<p>可以在字符串内查找特定字符串的位置，
以及检查字符串是否以特定字符串作为开头或结尾。例如：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (contains-etc)"?>
<pre class="prettyprint lang-dart">// 检查一个字符串是否包含另一个字符串。
assert('Never odd or even'.contains('odd'));

// 一个字符串是否以另一个字符串为开头?
assert('Never odd or even'.startsWith('Never'));

// 一个字符串是否以另一个字符串为结尾?
assert('Never odd or even'.endsWith('even'));

// 查找一个字符串在另一个字符串中的位置。
assert('Never odd or even'.indexOf('odd') == 6);</pre>

<h4 id="从字符串中提取数据">从字符串中提取数据</h4>

<p>可以获取字符串中的单个字符，将其作为字符串或者整数。
确切地说，实际上获取的是单独的UTF-16编码单元;
诸如高音谱号符号 (‘\u{1D11E}’) 之类的高编号字符分别为两个编码单元。</p>

<p>你也可以获取字符串中的子字符串或者将一个字符串分割为子字符串列表：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (substring-etc)"?>
<pre class="prettyprint lang-dart">// 抓取一个子字符串。
assert('Never odd or even'.substring(6, 9) == 'odd');

// 使用字符串模式分割字符串。
var parts = 'structured web apps'.split(' ');
assert(parts.length == 3);
assert(parts[0] == 'structured');

// 通过下标获取 UTF-16 编码单元（编码单元作为字符串）。
assert('Never odd or even'[0] == 'N');

// 使用 split() 传入一个空字符串参数，
// 得到一个所有字符的 list 集合；
// 有助于字符迭代。
for (var char in 'hello'.split('')) {
  print(char);
}

// 获取一个字符串的所有 UTF-16 编码单元。
var codeUnitList =
    'Never odd or even'.codeUnits.toList();
assert(codeUnitList[0] == 78);</pre>

<h4 id="首字母大小写转换">首字母大小写转换</h4>

<p>可以轻松的对字符串的首字母大小写进行转换：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (toUpperCase-toLowerCase)"?>
<pre class="prettyprint lang-dart">// 转换为首字母大写。
assert('structured web apps'.toUpperCase() ==
    'STRUCTURED WEB APPS');

// 转换为首字母小写。
assert('STRUCTURED WEB APPS'.toLowerCase() ==
    'structured web apps');</pre>

<div class="alert alert-info">
  <p><strong>提示：</strong>
这些方法不是在所有语言上都有效的。例如，
土耳其字母表的无点 <em>I</em> 转换是不正确的。</p>
</div>

<h4 id="trimming-和空字符串">Trimming 和空字符串</h4>

<p>使用 <code class="highlighter-rouge">trim()</code> 移除首尾空格。
使用 <code class="highlighter-rouge">isEmpty</code> 检查一个字符串是否为空（长度为0）。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (trim-etc)"?>
<pre class="prettyprint lang-dart">// Trim a string.
assert('  hello  '.trim() == 'hello');

// 检查字符串是否为空。
assert(''.isEmpty);

// 空格字符串不是空字符串。
assert('  '.isNotEmpty);</pre>

<h4 id="替换部分字符串">替换部分字符串</h4>

<p>字符串是不可变的对象，也就是说字符串可以创建但是不能被修改。
如果仔细阅读了 <a href="https://api.dartlang.org/stable/dart-core/String-class.html">String API docs,</a>
你会注意到，没有一个方法实际的改变了字符串的状态。
例如，方法 <code class="highlighter-rouge">replaceAll()</code> 返回一个新字符串，
并没有改变原始字符串：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (replace)"?>
<pre class="prettyprint lang-dart">var greetingTemplate = 'Hello, NAME!';
var greeting =
    greetingTemplate.replaceAll(RegExp('NAME'), 'Bob');

// greetingTemplate 没有改变。
assert(greeting != greetingTemplate);</pre>

<h4 id="构建一个字符串">构建一个字符串</h4>

<p>要以代码方式生成字符串，可以使用 StringBuffer 。
在调用 <code class="highlighter-rouge">toString()</code> 之前， StringBuffer 不会生成新字符串对象。
<code class="highlighter-rouge">writeAll()</code> 的第二个参数为可选参数，用来指定分隔符，
本例中使用空格作为分隔符。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (StringBuffer)"?>
<pre class="prettyprint lang-dart">var sb = StringBuffer();
sb
  ..write('Use a StringBuffer for ')
  ..writeAll(['efficient', 'string', 'creation'], ' ')
  ..write('.');

var fullString = sb.toString();

assert(fullString ==
    'Use a StringBuffer for efficient string creation.');</pre>

<h4 id="正则表达式">正则表达式</h4>

<p>RegExp类提供与JavaScript正则表达式相同的功能。
使用正则表达式可以对字符串进行高效搜索和模式匹配。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (RegExp)"?>
<pre class="prettyprint lang-dart">// 下面正则表达式用于匹配一个或多个数字。
var numbers = RegExp(r'\d+');

var allCharacters = 'llamas live fifteen to twenty years';
var someDigits = 'llamas live 15 to 20 years';

// contains() 能够使用正则表达式。
assert(!allCharacters.contains(numbers));
assert(someDigits.contains(numbers));

// 替换所有匹配对象为另一个字符串。
var exedOut = someDigits.replaceAll(numbers, 'XX');
assert(exedOut == 'llamas live XX to XX years');</pre>

<p>你也可以直接使用RegExp类。
Match 类提供对正则表达式匹配对象的访问。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (match)"?>
<pre class="prettyprint lang-dart">var numbers = RegExp(r'\d+');
var someDigits = 'llamas live 15 to 20 years';

// 检查正则表达式是否在字符串中匹配到对象。
assert(numbers.hasMatch(someDigits));

// 迭代所有匹配对象
for (var match in numbers.allMatches(someDigits)) {
  print(match.group(0)); // 15, then 20
}</pre>

<h4 id="更多信息">更多信息</h4>

<p>有关完整的方法列表，
请参考 <a href="https://api.dartlang.org/stable/dart-core/String-class.html">String API docs</a>。
另请参考 <a href="https://api.dartlang.org/stable/dart-core/StringBuffer-class.html">StringBuffer，</a>
<a href="https://api.dartlang.org/stable/dart-core/Pattern-class.html">Pattern，</a> <a href="https://api.dartlang.org/stable/dart-core/RegExp-class.html">RegExp，</a> 和 <a href="https://api.dartlang.org/stable/dart-core/Match-class.html">Match</a>
的 API 文档。</p>

<h3 id="集合">
<a id="集合" class="anchor" href="#%E9%9B%86%E5%90%88" aria-hidden="true"><span class="octicon octicon-link"></span></a>集合</h3>

<p>Dart 附带了核心集合 API ，其中包括 list ，set 和 map 类。</p>

<h4 id="lists">Lists</h4>

<p>如语言概览中介绍，<a href="#lists">lists</a> 可以通过字面量来创建和初始化。
另外，也可以使用 List 的构造函数。
List 类还定义了若干方法，用于向列表添加或删除项目。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (List)"?>
<pre class="prettyprint lang-dart">// 使用 List 构造函数。
var vegetables = List();

// 或者仅使用一个 list 字面量。
var fruits = ['apples', 'oranges'];

// 添加一个元素到 list 对象。
fruits.add('kiwis');

// 添加多个元素到 list 对象。
fruits.addAll(['grapes', 'bananas']);

// 获取 list 长度。
assert(fruits.length == 5);

// 移除一个元素到 list 对象。
var appleIndex = fruits.indexOf('apples');
fruits.removeAt(appleIndex);
assert(fruits.length == 4);

// 移除多个元素到 list 对象。
fruits.clear();
assert(fruits.length == 0);</pre>

<p>使用 <code class="highlighter-rouge">indexOf()</code> 方法查找一个对象在 list 中的下标值。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (indexOf)"?>
<pre class="prettyprint lang-dart">var fruits = ['apples', 'oranges'];

// 使用下标访问 list 中的元素
assert(fruits[0] == 'apples');

// 查找一个元素在 list 中的下标。
assert(fruits.indexOf('apples') == 0);</pre>

<p>使用 <code class="highlighter-rouge">sort()</code> 方法排序一个 list 。
你可以提供一个排序函数用于比较两个对象。
比较函数在 <em>小于</em> 时返回 \ &lt;0，<em>相等</em> 时返回 0，<em>bigger</em> 时返回 &gt; 0 。
下面示例中使用 <code class="highlighter-rouge">compareTo()</code> 函数，
该函数在 <a href="https://api.dartlang.org/stable/dart-core/Comparable-class.html">Comparable</a> 中定义，
并被 String 类实现。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (compareTo)"?>
<pre class="prettyprint lang-dart">var fruits = ['bananas', 'apples', 'oranges'];

// 排序一个 list 。
fruits.sort((a, b) =&gt; a.compareTo(b));
assert(fruits[0] == 'apples');</pre>

<p>list 是参数化类型，
因此可以指定 list 应该包含的元素类型：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (ListOfString)"?>
<pre class="prettyprint lang-dart">// 这个 list 只能包含字符串类型。
var fruits = List&lt;String&gt;();

fruits.add('apples');
var fruit = fruits[0];
assert(fruit is String);

// 产生静态分析警告，num 不是字符串类型。
fruits.add(5); // BAD: Throws exception in checked mode.</pre>

<?code-excerpt "misc/lib/library_tour/core/collections.dart (List-of-String)"?>
<pre class="prettyprint lang-dart fails-sa">fruits.add(5); // Error: 'int' can't be assigned to 'String'</pre>

<p>全部的方法介绍 ，请参考 <a href="https://api.dartlang.org/stable/dart-core/List-class.html">List API docs</a> 。</p>

<h4 id="sets">Sets</h4>

<p>在 Dart 中，set 是一个无序的，元素唯一的集合。
因为一个 set 是无序的，所以无法通过下标（位置）获取 set 中的元素。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Set)"?>
<pre class="prettyprint lang-dart">var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);
assert(ingredients.length == 3);

// 添加一个重复的元素是无效的。
ingredients.add('gold');
assert(ingredients.length == 3);

// 从 set 中移除一个元素。
ingredients.remove('gold');
assert(ingredients.length == 2);</pre>

<p>使用 <code class="highlighter-rouge">contains()</code> 和 <code class="highlighter-rouge">containsAll()</code> 来检查一个或多个元素是否在 set 中。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (contains)"?>
<pre class="prettyprint lang-dart">var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);

// 检查一个元素是否在该 set 中。
assert(ingredients.contains('titanium'));

// 检查多个元素是否在该 set 中。
assert(ingredients.containsAll(['titanium', 'xenon']));</pre>

<p>交集是另外两个 set 中的公共元素组成的 set 。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (intersection)"?>
<pre class="prettyprint lang-dart">var ingredients = Set();
ingredients.addAll(['gold', 'titanium', 'xenon']);

// 创建两个 set 的交集。
var nobleGases = Set.from(['xenon', 'argon']);
var intersection = ingredients.intersection(nobleGases);
assert(intersection.length == 1);
assert(intersection.contains('xenon'));</pre>

<p>全部的方法介绍 ，请参考 <a href="https://api.dartlang.org/stable/dart-core/Set-class.html">Set API docs</a> 。</p>

<h4 id="maps">Maps</h4>

<p>map 是一个无序的 key-value （键值对）集合，就是大家熟知的 <em>dictionary</em> 或者 <em>hash</em>。
map 将 kay 与 value 关联，以便于检索。和 JavaScript 不同，Dart 对象不是 map 。</p>

<p>声明 map 可以使用简洁的字面量语法，也可以使用传统构造函数：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Map)"?>
<pre class="prettyprint lang-dart">// map 通常使用字符串作为 key。
var hawaiianBeaches = {
  'Oahu': ['Waikiki', 'Kailua', 'Waimanalo'],
  'Big Island': ['Wailea Bay', 'Pololu Beach'],
  'Kauai': ['Hanalei', 'Poipu']
};

// map 可以通过构造函数构建。
var searchTerms = Map();

// map 是参数化类型；
// 可以指定一个 map 中 key 和 value 的类型。
var nobleGases = Map&lt;int, String&gt;();</pre>

<p>通过大括号语法可以为 map 添加，获取，设置元素。
使用 <code class="highlighter-rouge">remove()</code> 方法从 map 中移除键值对。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (remove)"?>
<pre class="prettyprint lang-dart">var nobleGases = {54: 'xenon'};

// 使用 key 检索 value 。
assert(nobleGases[54] == 'xenon');

// 检查 map 是否包含 key 。
assert(nobleGases.containsKey(54));

// 移除一个 key 及其 value。
nobleGases.remove(54);
assert(!nobleGases.containsKey(54));</pre>

<p>可以从一个 map 中检索出所有的 key 或所有的 value：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (keys)"?>
<pre class="prettyprint lang-dart">var hawaiianBeaches = {
  'Oahu': ['Waikiki', 'Kailua', 'Waimanalo'],
  'Big Island': ['Wailea Bay', 'Pololu Beach'],
  'Kauai': ['Hanalei', 'Poipu']
};

// 获取的所有的 key 是一个无序集合
// (可迭代 list 对象)。
var keys = hawaiianBeaches.keys;

assert(keys.length == 3);
assert(Set.from(keys).contains('Oahu'));

// 获取的所有的 value 是一个无序集合
// (可迭代 list 对象).
var values = hawaiianBeaches.values;
assert(values.length == 3);
assert(values.any((v) =&gt; v.contains('Waikiki')));</pre>

<p>使用 <code class="highlighter-rouge">containsKey()</code> 方法检查一个 map 中是否包含某个key 。
因为 map 中的 value 可能会是 null ，
所有通过 key 获取 value，并通过判断 value 是否为 null 来判断 key 是否存在是不可靠的。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (containsKey)"?>
<pre class="prettyprint lang-dart">var hawaiianBeaches = {
  'Oahu': ['Waikiki', 'Kailua', 'Waimanalo'],
  'Big Island': ['Wailea Bay', 'Pololu Beach'],
  'Kauai': ['Hanalei', 'Poipu']
};

assert(hawaiianBeaches.containsKey('Oahu'));
assert(!hawaiianBeaches.containsKey('Florida'));</pre>

<p>如果当且仅当该 key 不存在于 map 中，且要为这个 key 赋值，
可使用<code class="highlighter-rouge">putIfAbsent（）</code>方法。
该方法需要一个方法返回这个 value 。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (putIfAbsent)"?>
<pre class="prettyprint lang-dart">var teamAssignments = {};
teamAssignments.putIfAbsent(
    'Catcher', () =&gt; pickToughestKid());
assert(teamAssignments['Catcher'] != null);</pre>

<p>全部的方法介绍 ，请参考 <a href="https://api.dartlang.org/stable/dart-core/Map-class.html">Map API docs</a> 。</p>

<h4 id="公共集合方法">公共集合方法</h4>

<p>List, Set, 和 Map 共享许多集合中的常用功能。
其中一些常见功能由 Iterable 类定义，
这些函数由 List 和 Set 实现。</p>

<div class="alert alert-info">
  <p><strong>提示：</strong>
虽然Map没有实现 Iterable，
但可以使用 Map <code class="highlighter-rouge">keys</code> 和 <code class="highlighter-rouge">values</code> 属性从中获取 Iterable 对象。</p>
</div>

<p>使用 <code class="highlighter-rouge">isEmpty</code> 和 <code class="highlighter-rouge">isNotEmpty</code> 方法可以检查 list， set 或 map 对象中是否包含元素：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (isEmpty)"?>
<pre class="prettyprint lang-dart">var coffees = [];
var teas = ['green', 'black', 'chamomile', 'earl grey'];
assert(coffees.isEmpty);
assert(teas.isNotEmpty);</pre>

<p>使用 <code class="highlighter-rouge">forEach()</code> 可以让 list， set 或 map 对象中的每个元素都使用一个方法。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (List.forEach)"?>
<pre class="prettyprint lang-dart">var teas = ['green', 'black', 'chamomile', 'earl grey'];

teas.forEach((tea) =&gt; print('I drink $tea'));</pre>

<p>当在 map 对象上调用 `forEach() 方法时，函数必须带两个参数（key 和 value）：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Map.forEach)"?>
<pre class="prettyprint lang-dart">hawaiianBeaches.forEach((k, v) {
  print('I want to visit $k and swim at $v');
  // 我想去瓦胡岛并且在
  // [Waikiki, Kailua, Waimanalo]游泳， 等等。
});</pre>

<p>Iterable 提供 <code class="highlighter-rouge">map()</code> 方法，这个方法将所有结果返回到一个对象中。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (List.map)"?>
<pre class="prettyprint lang-dart">var teas = ['green', 'black', 'chamomile', 'earl grey'];

var loudTeas = teas.map((tea) =&gt; tea.toUpperCase());
loudTeas.forEach(print);</pre>

<div class="alert alert-info">
  <p><strong>提示：</strong>
<code class="highlighter-rouge">map()</code> 方法返回的对象是一个 <em>懒求值（lazily evaluated）</em>对象：
只有当访问对象里面的元素时，函数才会被调用。</p>
</div>

<p>使用 <code class="highlighter-rouge">map().toList()</code> 或 <code class="highlighter-rouge">map().toSet()</code> ，
可以强制在每个项目上立即调用函数。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (toList)"?>
<pre class="prettyprint lang-dart">var loudTeas =
    teas.map((tea) =&gt; tea.toUpperCase()).toList();</pre>

<p>使用 Iterable 的 <code class="highlighter-rouge">where()</code> 方法可以获取所有匹配条件的元素。
使用 Iterable 的 <code class="highlighter-rouge">any()</code> 和 <code class="highlighter-rouge">every()</code> 方法可以检查部分或者所有元素是否匹配某个条件。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (where-etc)"?>
<pre class="prettyprint lang-dart">var teas = ['green', 'black', 'chamomile', 'earl grey'];

// 洋甘菊不含咖啡因。
bool isDecaffeinated(String teaName) =&gt;
    teaName == 'chamomile';

// 使用 where() 来查找元素，
// 这些元素在给定的函数中返回 true 。
var decaffeinatedTeas =
    teas.where((tea) =&gt; isDecaffeinated(tea));
// 或者 teas.where(isDecaffeinated)

// 使用 any() 来检查集合中是否至少有一个元素满足条件。
assert(teas.any(isDecaffeinated));

// 使用 every() 来检查集合中是否所有元素满足条件。
assert(!teas.every(isDecaffeinated));</pre>

<p>有关方法的完整列表，请参考 <a href="https://api.dartlang.org/stable/dart-core/Iterable-class.html">Iterable API docs,</a> 以及
<a href="https://api.dartlang.org/stable/dart-core/List-class.html">List,</a> <a href="https://api.dartlang.org/stable/dart-core/Set-class.html">Set,</a> and <a href="https://api.dartlang.org/stable/dart-core/Map-class.html">Map.</a></p>

<h3 id="uri">
<a id="uri" class="anchor" href="#uri" aria-hidden="true"><span class="octicon octicon-link"></span></a>URI</h3>

<p>在使用 URI（可能你会称它为 <em>URLs</em>） 时，<a href="https://api.dartlang.org/stable/dart-core/Uri-class.html">Uri 类</a> 提供对字符串的编解码操作。
这些函数用来处理 URI 特有的字符，例如 <code class="highlighter-rouge">＆</code> 和 <code class="highlighter-rouge">=</code> 。
Uri 类还可以解析和处理 URI—host，port，scheme等组件。</p>

<h4 id="编码和解码完整合法的uri">编码和解码完整合法的URI</h4>

<p>使用 <code class="highlighter-rouge">encodeFull()</code> 和 <code class="highlighter-rouge">decodeFull()</code> 方法，
对 URI 中除了特殊字符（例如 <code class="highlighter-rouge">/</code>， <code class="highlighter-rouge">:</code>， <code class="highlighter-rouge">&amp;</code>， <code class="highlighter-rouge">#</code>）以外的字符进行编解码，
这些方法非常适合编解码完整合法的 URI，并保留 URI 中的特殊字符。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (encodeFull)"?>
<pre class="prettyprint lang-dart">var uri = 'http://example.org/api?foo=some message';

var encoded = Uri.encodeFull(uri);
assert(encoded ==
    'http://example.org/api?foo=some%20message');

var decoded = Uri.decodeFull(encoded);
assert(uri == decoded);</pre>

<p>注意上面代码只编码了 <code class="highlighter-rouge">some</code> 和 <code class="highlighter-rouge">message</code> 之间的空格。</p>

<h4 id="编码和解码-uri-组件">编码和解码 URI 组件</h4>

<p>使用 <code class="highlighter-rouge">encodeComponent()</code> 和 <code class="highlighter-rouge">decodeComponent()</code> 方法，
对 URI 中具有特殊含义的所有字符串字符，特殊字符包括（但不限于）<code class="highlighter-rouge">/</code>， <code class="highlighter-rouge">&amp;</code>， 和  <code class="highlighter-rouge">:</code>。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (encodeComponent)"?>
<pre class="prettyprint lang-dart">var uri = 'http://example.org/api?foo=some message';

var encoded = Uri.encodeComponent(uri);
assert(encoded ==
    'http%3A%2F%2Fexample.org%2Fapi%3Ffoo%3Dsome%20message');

var decoded = Uri.decodeComponent(encoded);
assert(uri == decoded);</pre>

<p>注意上面代码编码了所有的字符。例如 <code class="highlighter-rouge">/</code> 被编码为 <code class="highlighter-rouge">%2F</code>。</p>

<h4 id="解析-uri">解析 URI</h4>

<p>使用 Uri 对象的字段（例如 <code class="highlighter-rouge">path</code>），
来获取一个 Uri 对象或者 URI 字符串的一部分。
使用 <code class="highlighter-rouge">parse()</code> 静态方法，可以使用字符串创建 Uri 对象。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Uri.parse)"?>
<pre class="prettyprint lang-dart">var uri =
    Uri.parse('http://example.org:8080/foo/bar#frag');

assert(uri.scheme == 'http');
assert(uri.host == 'example.org');
assert(uri.path == '/foo/bar');
assert(uri.fragment == 'frag');
assert(uri.origin == 'http://example.org:8080');</pre>

<p>有关 URI 组件的更多内容，参考 <a href="https://api.dartlang.org/stable/dart-core/Uri-class.html">Uri API docs</a> 。</p>

<h4 id="构建-uri">构建 URI</h4>

<p>使用 <code class="highlighter-rouge">Uri()</code> 构造函数，可以将各组件部分构建成 URI 。</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Uri)"?>
<pre class="prettyprint lang-dart">var uri = Uri(
    scheme: 'http',
    host: 'example.org',
    path: '/foo/bar',
    fragment: 'frag');
assert(
    uri.toString() == 'http://example.org/foo/bar#frag');</pre>

<h3 id="日期和时间">
<a id="日期和时间" class="anchor" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>日期和时间</h3>

<p>DateTime 对象代表某个时刻，时区可以是 UTC 或者 本地时区。</p>

<p>DateTime 对象可以通过若干构造函数创建：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (DateTime)"?>
<pre class="prettyprint lang-dart">// 获取当前时刻。
var now = DateTime.now();

// 更具本地时区创建 DateTime 对象。
var y2k = DateTime(2000); // January 1, 2000

// 指定年月日。
y2k = DateTime(2000, 1, 2); // January 2, 2000

// 将日期指定为 UTC 时区。
y2k = DateTime.utc(2000); // 1/1/2000, UTC

// 指定自Unix纪元以来，以毫秒为单位的日期和时间。
y2k = DateTime.fromMillisecondsSinceEpoch(946684800000,
    isUtc: true);

// 解析ISO 8601日期。
y2k = DateTime.parse('2000-01-01T00:00:00Z');</pre>

<p>日期中 <code class="highlighter-rouge">millisecondsSinceEpoch</code> 属性返回自 “Unix纪元（January 1, 1970, UTC）“以来的毫秒数：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (millisecondsSinceEpoch)"?>
<pre class="prettyprint lang-dart">// 1/1/2000, UTC
var y2k = DateTime.utc(2000);
assert(y2k.millisecondsSinceEpoch == 946684800000);

// 1/1/1970, UTC
var unixEpoch = DateTime.utc(1970);
assert(unixEpoch.millisecondsSinceEpoch == 0);</pre>

<p>使用 Duration 类来计算两个日期的查，也可以对时刻进行前移和后移操作：</p>

<?code-excerpt "misc/test/library_tour/core_test.dart (Duration)"?>
<pre class="prettyprint lang-dart">var y2k = DateTime.utc(2000);

// 增加一年。
var y2001 = y2k.add(const Duration(days: 366));
assert(y2001.year == 2001);

// 减少30天。
var december2000 =
    y2001.subtract(const Duration(days: 30));
assert(december2000.year == 2000);
assert(december2000.month == 12);

// 计算两个时刻之间的查，
// 返回 Duration 对象。
var duration = y2001.difference(y2k);
assert(duration.inDays == 366); // y2k was a leap year.</pre>

<div class="alert alert-warning">
  <p><strong>警告：</strong>
由于时钟转换（例如，夏令时）的原因，
使用 Duration 对 DateTime 按天移动可能会有问题。 
如果要按照天数来位移时间，请使用 UTC 日期。</p>
</div>

<p>参考 <a href="https://api.dartlang.org/stable/dart-core/DateTime-class.html">DateTime</a> 和 <a href="https://api.dartlang.org/stable/dart-core/Duration-class.html">Duration</a> API 文档了解全部方法列表。</p>

<h3 id="工具类">
<a id="工具类" class="anchor" href="#%E5%B7%A5%E5%85%B7%E7%B1%BB" aria-hidden="true"><span class="octicon octicon-link"></span></a>工具类</h3>

<p>核心库包含各种工具类，可用于排序，映射值以及迭代。</p>

<h4 id="比较对象">比较对象</h4>

<p>如果实现了 <a href="https://api.dartlang.org/stable/dart-core/Comparable-class.html">Comparable</a> 接口，
也就是说可以将该对象与另一个对象进行比较，
通常用于排序。
<code class="highlighter-rouge">compareTo()</code> 方法在 <em>小于</em> 时返回 &lt; 0，
在 <em>相等</em> 时返回 0，
在 <em>大于</em> 时返回  &gt; 0。</p>

<?code-excerpt "misc/lib/library_tour/core/comparable.dart"?>
<pre class="prettyprint lang-dart">class Line implements Comparable&lt;Line&gt; {
  final int length;
  const Line(this.length);

  @override
  int compareTo(Line other) =&gt; length - other.length;
}

void main() {
  var short = const Line(1);
  var long = const Line(100);
  assert(short.compareTo(long) &lt; 0);
}</pre>

<h4 id="implementing-map-keys">Implementing map keys</h4>

<p>在 Dart 中每个对象会默认提供一个整数的哈希值，
因此在 map 中可以作为 key 来使用，
重写 <code class="highlighter-rouge">hashCode</code> 的 getter 方法来生成自定义哈希值。
如果重写 <code class="highlighter-rouge">hashCode</code> 的 getter 方法，那么可能还需要重写 <code class="highlighter-rouge">==</code> 运算符。
相等的（通过 <code class="highlighter-rouge">==</code> ）对象必须拥有相同的哈希值。
哈希值并不要求是唯一的， 但是应该具有良好的分布形态。。</p>

<?code-excerpt "misc/lib/library_tour/core/hash_code.dart"?>
<pre class="prettyprint lang-dart">class Person {
  final String firstName, lastName;

  Person(this.firstName, this.lastName);

  // 重写 hashCode，实现策略源于  Effective Java，
  // 第11章。
  @override
  int get hashCode {
    int result = 17;
    result = 37 * result + firstName.hashCode;
    result = 37 * result + lastName.hashCode;
    return result;
  }

  // 如果重写了 hashCode，通常应该从新实现 == 操作符。
  @override
  bool operator ==(dynamic other) {
    if (other is! Person) return false;
    Person person = other;
    return (person.firstName == firstName &amp;&amp;
        person.lastName == lastName);
  }
}

void main() {
  var p1 = Person('Bob', 'Smith');
  var p2 = Person('Bob', 'Smith');
  var p3 = 'not a person';
  assert(p1.hashCode == p2.hashCode);
  assert(p1 == p2);
  assert(p1 != p3);
}</pre>

<h4 id="迭代">迭代</h4>

<p>Iterable][] 和 <a href="https://api.dartlang.org/stable/dart-core/Iterator-class.html">Iterator</a> 类支持 for-in 循环。
当创建一个类的时候，继承或者实现 Iterable，可以为该类提供用于 for-in 循环的 Iterators。
实现 Iterator 来定义实际的遍历操作。</p>

<?code-excerpt "misc/lib/library_tour/core/iterator.dart"?>
<pre class="prettyprint lang-dart">class Process {
  // Represents a process...
}

class ProcessIterator implements Iterator&lt;Process&gt; {
  @override
  Process get current =&gt; ...
  @override
  bool moveNext() =&gt; ...
}

// A mythical class that lets you iterate through all
// processes. Extends a subclass of [Iterable].
class Processes extends IterableBase&lt;Process&gt; {
  @override
  final Iterator&lt;Process&gt; iterator = ProcessIterator();
}

void main() {
  // Iterable objects can be used with for-in.
  for (var process in Processes()) {
    // Do something with the process.
  }
}</pre>

<h3 id="异常">
<a id="异常" class="anchor" href="#%E5%BC%82%E5%B8%B8" aria-hidden="true"><span class="octicon octicon-link"></span></a>异常</h3>

<p>Dart 核心库定义了很多公共的异常和错误类。
异常通常是一些可以预见和预知的情况。
错误是无法预见或者预防的情况。</p>

<p>两个最常见的错误：</p>

<dl>
  <dt><a href="https://api.dartlang.org/stable/dart-core/NoSuchMethodError-class.html">NoSuchMethodError</a></dt>
  <dd>
    <p>当方法的接受对象（可能为null）没有实现该方法时抛出。</p>
  </dd>
  <dt><a href="https://api.dartlang.org/stable/dart-core/ArgumentError-class.html">ArgumentError</a></dt>
  <dd>
    <p>当方法在接受到一个不合法参数时抛出。</p>
  </dd>
</dl>

<p>通常通过抛出一个应用特定的异常，来表示应用发生了错误。
通过实现 Exception 接口来自定义异常。</p>

<?code-excerpt "misc/lib/library_tour/core/exception.dart"?>
<pre class="prettyprint lang-dart">class FooException implements Exception {
  final String msg;

  const FooException([this.msg]);

  @override
  String toString() =&gt; msg ?? 'FooException';
}</pre>

<p>更多内容，参考 <a href="#exceptions">Exceptions</a> 以及 <a href="https://api.dartlang.org/stable/dart-core/Exception-class.html">Exception API 文档。</a></p>

<h2 id="dartasync---异步编程">
<a id="dartasync---异步编程" class="anchor" href="#dartasync---%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>dart:async - 异步编程</h2>

<p>异步编程通常使用回调方法来实现，但是 Dart
提供了其他方案：<a href="https://api.dartlang.org/stable/dart-async/Future-class.html">Future</a> 和 <a href="https://api.dartlang.org/stable/dart-async/Stream-class.html">Stream</a> 对象。
Future 类似与 JavaScript 中的 Promise ，
代表在将来某个时刻会返回一个结果。
Stream 类可以用来获取一系列的值，比如，一些列事件。
Future， Stream，以及更多内容，参考
dart:async library (<a href="https://api.dartlang.org/stable/dart-async/dart-async-library.html">API reference</a>)。</p>

<div class="alert alert-info">
  <p><strong>提示：</strong>
你并不总是需要直接使用 Future 或 Stream 的 API。
Dart 语言支持使用关键字（例如，<code class="highlighter-rouge">async</code> 和 <code class="highlighter-rouge">await</code> ）来实现异步编程。
更多详情，参考语言概览中 <a href="/guides/language/language-tour#asynchrony-support">Asynchrony support</a>。</p>
</div>

<p>dart:async 库可以工作在 web 应用及 command-line 应用。
通过 import dart:async 来使用。</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (import)"?>
<pre class="prettyprint lang-dart">import 'dart:async';</pre>

<aside class="alert alert-info">
  <p><strong>版本提示：</strong>
  从 Dart 2.1 开始，使用 Future 和 Stream 不需要导入 dart:async ，
  因为 dart:core 库 export 了这些类。</p>
</aside>

<h3 id="future">
<a id="future" class="anchor" href="#future" aria-hidden="true"><span class="octicon octicon-link"></span></a>Future</h3>

<p>在 Dart 库中随处可见 Future 对象，通常异步函数返回的对象就是一个 Future。
当一个 future <em>完成执行后</em>，future 中的值就已经可以使用了。</p>

<h4 id="使用-await">使用 await</h4>

<p>在直接使用 Future API 前，首先应该考虑 <code class="highlighter-rouge">await</code> 来替代。
代码中使用 <code class="highlighter-rouge">await</code> 表达式会比直接使用 Future API 更容易理解。</p>

<p>阅读思考下面代码。
代码使用 Future 的 <code class="highlighter-rouge">then()</code> 方法在同一行执行了三个异步函数，
要等待上一个执行完成，再执行下一个任务之。</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (runUsingFuture)"?>
<pre class="prettyprint lang-dart">runUsingFuture() {
  // ...
  findEntryPoint().then((entryPoint) {
    return runExecutable(entryPoint, args);
  }).then(flushThenExit);
}</pre>

<p>通过 await 表达式实现等价的代码，
看起来非常像同步代码：</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (runUsingAsyncAwait)"?>
<pre class="prettyprint lang-dart">runUsingAsyncAwait() async {
  // ...
  var entryPoint = await findEntryPoint();
  var exitCode = await runExecutable(entryPoint, args);
  await flushThenExit(exitCode);
}</pre>

<p>async 函数能够捕获来自 Future 的异常。
例如：</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (catch)"?>
<pre class="prettyprint lang-dart">var entryPoint = await findEntryPoint();
try {
  var exitCode = await runExecutable(entryPoint, args);
  await flushThenExit(exitCode);
} catch (e) {
  // Handle the error...
}</pre>

<div class="alert alert-warning">
  <p><strong>重要：</strong>
async 函数 返回 Future 对象。
如果你不希望你的函数返回一个 future 对象，
可以使用其他方案。
例如，你可以在你的方法中调用一个 async 方法。</p>
</div>

<p>更多关于 <code class="highlighter-rouge">await</code> 的使用及相关的 Dart 语言特征，参考
<a href="/guides/language/language-tour#asynchrony-support">Asynchrony support</a>。</p>

<h4 id="基本用法">基本用法</h4>

<p>当 future 执行完成后，<code class="highlighter-rouge">then()</code> 中的代码会被执行。</p>

<p><code class="highlighter-rouge">then()</code> 中的代码会在 future 完成后被执行。
例如，
<code class="highlighter-rouge">HttpRequest.getString()</code> 返回一个 future 对象，因为 HTTP 请求可能需要一段时间。
当 Future 完成并且保证字符串值有效后，使用 <code class="highlighter-rouge">then()</code> 来执行你需要的代码：</p>

<?code-excerpt "misc/lib/library_tour/async/basic.dart (then)"?>
<pre class="prettyprint lang-dart">HttpRequest.getString(url).then((String result) {
  print(result);
});</pre>

<p>使用 <code class="highlighter-rouge">catchError()</code> 来处理一些 Future 对象可能抛出的错误或者异常。</p>

<?code-excerpt "misc/lib/library_tour/async/basic.dart (catchError)"?>
<pre class="prettyprint lang-dart">HttpRequest.getString(url).then((String result) {
  print(result);
}).catchError((e) {
  // Handle or ignore the error.
});</pre>

<p><code class="highlighter-rouge">then().catchError()</code> 组合是 <code class="highlighter-rouge">try</code>-<code class="highlighter-rouge">catch</code> 的异步版本。</p>

<div class="alert alert-warning">
  <p><strong>重要：</strong>
确保调用 <code class="highlighter-rouge">catchError()</code> 方式在 <code class="highlighter-rouge">then()</code> 的结果上，而不是在原来的 Future 对象上调用。
否则的话，<code class="highlighter-rouge">catchError()</code> 就只能处理原来 Future 对象抛出的异常，
而无法处理 <code class="highlighter-rouge">then()</code> 代码里面的异常。</p>
</div>

<h4 id="链式异步编程">链式异步编程</h4>

<p><code class="highlighter-rouge">then()</code> 方法返回一个 Future 对象， 
这样就提供了一个非常好的方式让多个异步方法按顺序依次执行。
如果用 <code class="highlighter-rouge">then()</code> 注册的回调返回一个 Future ，
那么 <code class="highlighter-rouge">then()</code> 返回一个等价的 Future 。 
如果回调返回任何其他类型的值，
那么 <code class="highlighter-rouge">then()</code> 会创建一个以该值完成的新 Future 。</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (then-chain)"?>
<pre class="prettyprint lang-dart">Future result = costlyQuery(url);
result
    .then((value) =&gt; expensiveWork(value))
    .then((_) =&gt; lengthyComputation())
    .then((_) =&gt; print('Done!'))
    .catchError((exception) {
  /* Handle exception... */
});</pre>

<p>在上面的示例中，方法按下面顺序执行：</p>

<ol>
  <li><code class="highlighter-rouge">costlyQuery()</code></li>
  <li><code class="highlighter-rouge">expensiveWork()</code></li>
  <li><code class="highlighter-rouge">lengthyComputation()</code></li>
</ol>

<p>这是使用 await 编写的等效代码：</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (then-chain-as-await)"?>
<pre class="prettyprint lang-dart">try {
  final value = await costlyQuery(url);
  await expensiveWork(value);
  await lengthyComputation();
  print('Done!');
} catch (e) {
  /* Handle exception... */
}</pre>

<h4 id="等待多个-future">等待多个 Future</h4>

<p>有时代码逻辑需要调用多个异步函数，
并等待它们全部完成后再继续执行。
使用 <a href="https://api.dartlang.org/stable/dart-async/Future/wait.html">Future.wait()</a> 静态方法管理多个 Future 以及等待它们完成：</p>

<?code-excerpt "misc/lib/library_tour/async/future.dart (wait)" replace="/elideBody;/\/* ... *\//g"?>
<pre class="prettyprint lang-dart">Future deleteLotsOfFiles() async =&gt;  ...
Future copyLotsOfFiles() async =&gt;  ...
Future checksumLotsOfOtherFiles() async =&gt;  ...

await Future.wait([
  deleteLotsOfFiles(),
  copyLotsOfFiles(),
  checksumLotsOfOtherFiles(),
]);
print('Done with all the long steps!');</pre>

<h3 id="stream">
<a id="stream" class="anchor" href="#stream" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stream</h3>

<p>在 Dart API 中 Stream 对象随处可见，Stream 用来表示一些列数据。
例如，HTML 中的按钮点击就是通过 stream 传递的。
同样也可以将文件作为数据流来读取。</p>

<h4 id="异步循环">异步循环</h4>

<p>有时，可以使用异步 for 循环 <code class="highlighter-rouge">await for</code> ，来替代 Stream API 。</p>

<p>思考下面示例函数。
它使用 Stream 的 <code class="highlighter-rouge">listen()</code> 方法来订阅文件列表，
传入一个搜索文件或目录的函数。</p>

<!-- OLD dart-tutorials-samples/cmdline/bin/dgrep.dart -->
<?code-excerpt "misc/lib/library_tour/async/stream.dart (listen)" replace="/listen/[!$&!]/g"?>
<pre class="prettyprint lang-dart">void main(List&lt;String&gt; arguments) {
  // ...
  FileSystemEntity.isDirectory(searchPath).then((isDir) {
    if (isDir) {
      final startingDir = Directory(searchPath);
      startingDir
          .list(
              recursive: argResults[recursive],
              followLinks: argResults[followLinks])
          .<span class="highlight">listen</span>((entity) {
        if (entity is File) {
          searchFile(entity, searchTerms);
        }
      });
    } else {
      searchFile(File(searchPath), searchTerms);
    }
  });
}</pre>

<p>下面是使用 await 表达式和异步 for 循环 (<code class="highlighter-rouge">await for</code>) 实现的等价的代码，
看起来更像是同步代码：</p>

<?code-excerpt "misc/lib/library_tour/async/stream.dart (await-for)" replace="/await for/[!$&!]/g"?>
<pre class="prettyprint lang-dart">Future main(List&lt;String&gt; arguments) async {
  // ...
  if (await FileSystemEntity.isDirectory(searchPath)) {
    final startingDir = Directory(searchPath);
    <span class="highlight">await for</span> (var entity in startingDir.list(
        recursive: argResults[recursive],
        followLinks: argResults[followLinks])) {
      if (entity is File) {
        searchFile(entity, searchTerms);
      }
    }
  } else {
    searchFile(File(searchPath), searchTerms);
  }
}</pre>

<div class="alert alert-warning">
  <p><strong>重要：</strong>
在使用 <code class="highlighter-rouge">await for</code> 前，确认这样能保持代码清晰，
并希望获取所有 stream 的结果。
例如，你通常并 <strong>不</strong> 会使用 <code class="highlighter-rouge">await for</code> 来监听 DOM 事件，
因为 DOM 会发送无尽的流事件。
如果在同一行使用 <code class="highlighter-rouge">await for</code> 注册两个 DOM 事件，
那么第二个事件永远不会被处理。</p>
</div>

<p>有关 <code class="highlighter-rouge">await</code> 的使用及 Dart 语言的相关信息，参考
<a href="/guides/language/language-tour#asynchrony-support">Asynchrony support</a>。</p>

<h4 id="监听流数据stream-data">监听流数据（stream data）</h4>

<p>使用 <code class="highlighter-rouge">await for</code> 或者使用 <code class="highlighter-rouge">listen()</code> 方法监听 stream，
来获取每个到达的数据流值：</p>

<?code-excerpt "misc/lib/library_tour/async/stream_web.dart (listen)" replace="/await for/[!$&!]/g"?>
<pre class="prettyprint lang-dart">// 通过 ID 获取 button 并添加事件处理函数。
querySelector('#submitInfo').onClick.listen((e) {
  // 当 button 被点击是，该代码会执行。
  submitData();
});</pre>

<p>下面示例中，ID 为 “submitInfo” button 提供的 <code class="highlighter-rouge">onClick</code> 属性是一个 Stream 对象。</p>

<p>如果只关心其中一个事件，可以使用，例如，<code class="highlighter-rouge">first</code>， <code class="highlighter-rouge">last</code>，或 <code class="highlighter-rouge">single</code> 属性来获取。
要在处理时间前对事件进行测试，可以使用，例如 <code class="highlighter-rouge">firstWhere()</code>， <code class="highlighter-rouge">lastWhere()</code>， 或 <code class="highlighter-rouge">singleWhere()</code> 方法。</p>

<p>如果只关心事件中的一个子集，可以使用，例如，<code class="highlighter-rouge">skip()</code>， <code class="highlighter-rouge">skipWhile()</code>，<code class="highlighter-rouge">take()</code>，<code class="highlighter-rouge">takeWhile()</code>， 和 <code class="highlighter-rouge">where()</code>。</p>

<h4 id="传递流数据stream-data">传递流数据（stream data）</h4>

<p>常常，在使用流数据前需要改变数据的格式。
使用 <code class="highlighter-rouge">transform()</code> 方法生成具有不同类型数据的流：</p>

<?code-excerpt "misc/lib/library_tour/async/stream.dart (transform)"?>
<pre class="prettyprint lang-dart">var lines = inputStream
    .transform(utf8.decoder)
    .transform(LineSplitter());</pre>

<p>上面例子中使用了两个 transformer 。
第一个使用 utf8.decoder 将整型流转换为字符串流。
接着，使用了 LineSplitter 将字符串流转换为多行字符串流。
这些 transformer 来自 dart:convert 库
（参考<a href="#dartconvert---decoding-and-encoding-json-utf-8-and-more">dart:convert section</a>）。</p>

<h4 id="处理错误和完成">处理错误和完成</h4>

<p>处理错误和完成代码方式，
取决于使用的是 异步 for 循环（<code class="highlighter-rouge">await for</code>）还是 Stream API 。</p>

<p>如果使用的是异步 for 循环，
那么通过  try-catch 来处理错误。
代码位于异步 for 循环之后，
会在 stream 被关闭后执行。</p>

<?code-excerpt "misc/lib/library_tour/async/stream.dart (readFileAwaitFor)" replace="/try|catch/[!$&!]/g"?>
<pre class="prettyprint lang-dart">Future readFileAwaitFor() async {
  var config = File('config.txt');
  Stream&lt;List&lt;int&gt;&gt; inputStream = config.openRead();

  var lines = inputStream
      .transform(utf8.decoder)
      .transform(LineSplitter());
  <span class="highlight">try</span> {
    await for (var line in lines) {
      print('Got ${line.length} characters from stream');
    }
    print('file is now closed');
  } <span class="highlight">catch</span> (e) {
    print(e);
  }
}</pre>

<p>如果使用的是 Stream API，
那么通过注册 <code class="highlighter-rouge">onError</code> 监听来处理错误。
代码位于注册的 <code class="highlighter-rouge">onDone</code> 中，
会在 stream 被关闭后执行。</p>

<?code-excerpt "misc/lib/library_tour/async/stream.dart (onDone)" replace="/onDone|onError/[!$&!]/g"?>
<pre class="prettyprint lang-dart">var config = File('config.txt');
Stream&lt;List&lt;int&gt;&gt; inputStream = config.openRead();

inputStream
    .transform(utf8.decoder)
    .transform(LineSplitter())
    .listen((String line) {
  print('Got ${line.length} characters from stream');
}, <span class="highlight">onDone</span>: () {
  print('file is now closed');
}, <span class="highlight">onError</span>: (e) {
  print(e);
});</pre>

<h3 id="更多内容">
<a id="更多内容" class="anchor" href="#%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9" aria-hidden="true"><span class="octicon octicon-link"></span></a>更多内容</h3>

<p>更多在 command-line 应用中使用 Future 和 Stream 的实例，参考
<a href="/server/io-library-tour">dart:io tour.</a>
也可以参考下列文章和教程：</p>

<ul>
  <li><a href="/tutorials/language/futures">Asynchronous Programming: Futures</a></li>
  <li><a href="/guides/libraries/futures-error-handling">Futures and Error Handling</a></li>
  <li><a href="https://webdev.dartlang.org/articles/performance/event-loop">The Event Loop and Dart</a></li>
  <li><a href="/tutorials/language/streams">Asynchronous Programming: Streams</a></li>
  <li><a href="/articles/libraries/creating-streams">Creating Streams in Dart</a></li>
</ul>

<h2 id="dartmath---数学和随机数">
<a id="dartmath---数学和随机数" class="anchor" href="#dartmath---%E6%95%B0%E5%AD%A6%E5%92%8C%E9%9A%8F%E6%9C%BA%E6%95%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>dart:math - 数学和随机数</h2>

<p>dart:math 库（<a href="https://api.dartlang.org/stable/dart-math/dart-math-library.html">API reference</a>）
提供通用的功能，例如，正弦和余弦，
最大值和最小值，以及数学常数，例如 <em>pi</em> 和 <em>e</em>。
大多数在 Math 库中的功能是作为顶级函数实现的。</p>

<p>通过 import dart:math 来引入使用该库。
下面的实例中使用 <code class="highlighter-rouge">math</code> 前缀，来说明顶级函数及常量源于 Math 库。</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (import)"?>
<pre class="prettyprint lang-dart">import 'dart:math';</pre>

<h3 id="三角函数">
<a id="三角函数" class="anchor" href="#%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>三角函数</h3>

<p>Math 库提供基本的三角函数：</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (trig)"?>
<pre class="prettyprint lang-dart">// Cosine
assert(cos(pi) == -1.0);

// Sine
var degrees = 30;
var radians = degrees * (pi / 180);
// radians is now 0.52359.
var sinOf30degrees = sin(radians);
// sin 30° = 0.5
assert((sinOf30degrees - 0.5).abs() &lt; 0.01);</pre>

<div class="alert alert-info">
  <p><strong>提示：</strong>
这些函数参数单位是弧度，不是角度！</p>
</div>

<h3 id="最大值和最小值">
<a id="最大值和最小值" class="anchor" href="#%E6%9C%80%E5%A4%A7%E5%80%BC%E5%92%8C%E6%9C%80%E5%B0%8F%E5%80%BC" aria-hidden="true"><span class="octicon octicon-link"></span></a>最大值和最小值</h3>

<p>Math 库提供 <code class="highlighter-rouge">max()</code> 和 <code class="highlighter-rouge">min()</code> 方法：</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (min-max)"?>
<pre class="prettyprint lang-dart">assert(max(1, 1000) == 1000);
assert(min(1, -1000) == -1000);</pre>

<h3 id="数学常数">
<a id="数学常数" class="anchor" href="#%E6%95%B0%E5%AD%A6%E5%B8%B8%E6%95%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>数学常数</h3>

<p>在 Math 库中可以找到你需要的数学常熟，例如，<em>pi</em>， <em>e</em> 等等：</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (constants)"?>
<pre class="prettyprint lang-dart">// See the Math library for additional constants.
print(e); // 2.718281828459045
print(pi); // 3.141592653589793
print(sqrt2); // 1.4142135623730951</pre>

<h3 id="随机数">
<a id="随机数" class="anchor" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0" aria-hidden="true"><span class="octicon octicon-link"></span></a>随机数</h3>

<p>使用 <a href="https://api.dartlang.org/stable/dart-math/Random-class.html">Random</a> 类产生随机数。
可以为 Random 构造函数提供一个可选的种子参数。</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (Random)"?>
<pre class="prettyprint lang-dart">var random = Random();
random.nextDouble(); // Between 0.0 and 1.0: [0, 1)
random.nextInt(10); // Between 0 and 9.</pre>

<p>也可以产生随机布尔值序列：</p>

<?code-excerpt "misc/test/library_tour/math_test.dart (Random-bool)"?>
<pre class="prettyprint lang-dart">var random = Random();
random.nextBool(); // true or false</pre>

<h3 id="更多内容-1">
<a id="更多内容-1" class="anchor" href="#%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>更多内容</h3>

<p>完整方法列表参考 <a href="https://api.dartlang.org/stable/dart-math/dart-math-library.html">Math API docs</a>。
在 API 文档中参考 <a href="https://api.dartlang.org/stable/dart-core/num-class.html">num,</a> <a href="https://api.dartlang.org/stable/dart-core/int-class.html">int,</a> 和 <a href="https://api.dartlang.org/stable/dart-core/double-class.html">double</a>。</p>

<h2 id="dartconvert---编解码jsonutf-8等">
<a id="dartconvert---编解码jsonutf-8等" class="anchor" href="#dartconvert---%E7%BC%96%E8%A7%A3%E7%A0%81jsonutf-8%E7%AD%89" aria-hidden="true"><span class="octicon octicon-link"></span></a>dart:convert - 编解码JSON，UTF-8等</h2>

<p>dart:convert 库 （<a href="https://api.dartlang.org/stable/dart-convert/dart-convert-library.html">API reference</a>）提供 JSON 和 UTF-8 转换器，
以及创建其他转换器。
<a href="https://www.json.org/">JSON</a> 是一种用于表示结构化对象和集合的简单文本格式。
<a href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a> 是一种常见的可变宽度编码，可以表示Unicode字符集中的每个字符。</p>

<p>dart:convert 库可以在 web 及 命令行应用中使用。
使用时，通过 import dart:convert 引入。</p>

<?code-excerpt "misc/test/library_tour/convert_test.dart (import)"?>
<pre class="prettyprint lang-dart">import 'dart:convert';</pre>

<h3 id="编解码json">
<a id="编解码json" class="anchor" href="#%E7%BC%96%E8%A7%A3%E7%A0%81json" aria-hidden="true"><span class="octicon octicon-link"></span></a>编解码JSON</h3>

<p>使用 <code class="highlighter-rouge">jsonDecode()</code> 解码 JSON 编码的字符串为 Dart 对象：</p>

<?code-excerpt "misc/test/library_tour/convert_test.dart (json-decode)"?>
<pre class="prettyprint lang-dart">// 提示：在 JSON 字符串中，必须使用双引号（"）,
// 而不是单引号（'）。
// 下面是 JSON 字符串，非 Dart 字符串。
var jsonString = '''
  [
    {"score": 40},
    {"score": 80}
  ]
''';

var scores = jsonDecode(jsonString);
assert(scores is List);

var firstScore = scores[0];
assert(firstScore is Map);
assert(firstScore['score'] == 40);</pre>

<p>使用 <code class="highlighter-rouge">jsonEncode()</code> 编码 Dart 对象为 JSON 格式的字符串：</p>

<?code-excerpt "misc/test/library_tour/convert_test.dart (json-encode)"?>
<pre class="prettyprint lang-dart">var scores = [
  {'score': 40},
  {'score': 80},
  {'score': 100, 'overtime': true, 'special_guest': null}
];

var jsonText = jsonEncode(scores);
assert(jsonText ==
    '[{"score":40},{"score":80},'
    '{"score":100,"overtime":true,'
    '"special_guest":null}]');</pre>

<p>只有 int， double， String， bool, null, List, 或者 Map 类型对象可以直接编码成 JSON。
List 和 Map 对象进行递归编码。</p>

<p>不能直接编码的对象有两种方式对其编码。
第一种方式是调用 <code class="highlighter-rouge">encode()</code> 时赋值第二个参数，
这个参数是一个函数，
该函数返回一个能够直接编码的对象
第二种方式是省略第二个参数，着这种情况下编码器调用对象的 <code class="highlighter-rouge">toJson()</code> 方法。
更多示例及 JSON 包相关链接，参考 <a href="/guides/json">JSON Support</a> 。</p>

<h3 id="编解码-utf-8-字符">
<a id="编解码-utf-8-字符" class="anchor" href="#%E7%BC%96%E8%A7%A3%E7%A0%81-utf-8-%E5%AD%97%E7%AC%A6" aria-hidden="true"><span class="octicon octicon-link"></span></a>编解码 UTF-8 字符</h3>

<p>使用 <code class="highlighter-rouge">utf8.decode()</code> 解码 UTF8 编码的字符创为 Dart 字符创：</p>

<?code-excerpt "misc/test/library_tour/convert_test.dart (utf8-decode)" replace="/ \/\/line-br.*//g"?>
<pre class="prettyprint lang-dart">List&lt;int&gt; utf8Bytes = [
  0xc3, 0x8e, 0xc3, 0xb1, 0xc5, 0xa3, 0xc3, 0xa9,
  0x72, 0xc3, 0xb1, 0xc3, 0xa5, 0xc5, 0xa3, 0xc3,
  0xae, 0xc3, 0xb6, 0xc3, 0xb1, 0xc3, 0xa5, 0xc4,
  0xbc, 0xc3, 0xae, 0xc5, 0xbe, 0xc3, 0xa5, 0xc5,
  0xa3, 0xc3, 0xae, 0xe1, 0xbb, 0x9d, 0xc3, 0xb1
];

var funnyWord = utf8.decode(utf8Bytes);

assert(funnyWord == 'Îñţérñåţîöñåļîžåţîờñ');</pre>

<p>将 UTF-8 字符串流转换为 Dart 字符串，为 Stream 的 <code class="highlighter-rouge">transform()</code> 方法上指定 <code class="highlighter-rouge">utf8.decoder</code>：</p>

<?code-excerpt "misc/test/library_tour/io_test.dart (utf8-decoder)" replace="/utf8.decoder/[!$&!]/g"?>
<pre class="prettyprint lang-dart">var lines = inputStream
    .transform(<span class="highlight">utf8.decoder</span>)
    .transform(LineSplitter());
try {
  await for (var line in lines) {
    print('Got ${line.length} characters from stream');
  }
  print('file is now closed');
} catch (e) {
  print(e);
}</pre>

<p>使用 <code class="highlighter-rouge">utf8.encode()</code> 将 Dart 字符串编码为一个 UTF8 编码的字节流：</p>

<?code-excerpt "misc/test/library_tour/convert_test.dart (utf8-encode)" replace="/ \/\/line-br.*//g"?>
<pre class="prettyprint lang-dart">List&lt;int&gt; encoded = utf8.encode('Îñţérñåţîöñåļîžåţîờñ');

assert(encoded.length == utf8Bytes.length);
for (int i = 0; i &lt; encoded.length; i++) {
  assert(encoded[i] == utf8Bytes[i]);
}</pre>

<h3 id="其他功能">
<a id="其他功能" class="anchor" href="#%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD" aria-hidden="true"><span class="octicon octicon-link"></span></a>其他功能</h3>

<p>dart:convert 库同样包含 ASCII 和 ISO-8859-1 (Latin1) 转换器。
更多详情，参考 <a href="https://api.dartlang.org/stable/dart-convert/dart-convert-library.html">API docs for the dart:convert library。</a></p>

<h2 id="总结">
<a id="总结" class="anchor" href="#%E6%80%BB%E7%BB%93" aria-hidden="true"><span class="octicon octicon-link"></span></a>总结</h2>

<p>本页向您介绍了 Dart 内置库中最常用的功能。
但是，并没有涵盖所有内置库。
您可能想要查看的其他内容包括 <a href="https://api.dartlang.org/stable/dart-collection/dart-collection-library.html">dart:collection</a> 和 <a href="https://api.dartlang.org/stable/dart-typed_data/dart-typed_data-library.html">dart:typed_data,</a> ，
以及特定于平台的库，如 <a href="https://webdev.dartlang.org/guides/web-programming">Dart web development libraries</a> 和 <a href="https://docs.flutter.io/">Flutter libraries</a> 。</p>

<p>您可以使用 <a href="/tools/pub">pub tool</a> 工具获得更多库。
<a href="https://pub.dartlang.org/packages/collection">collection，</a>
<a href="https://pub.dartlang.org/packages/crypto">crypto，</a>
<a href="https://pub.dartlang.org/packages/http">http，</a>
<a href="https://pub.dartlang.org/packages/intl">intl，</a> 以及
<a href="https://pub.dartlang.org/packages/test">test</a>，
以上只是简单的列举了一些可以通过 pub 安装的库。</p>

<p>要了解有关 Dart 语言的更多信息，请参考 <a href="/guides/language/language-tour">language tour</a>。</p>


          

        </div>
      </article>
    </main>
    <footer id="page-footer">
  <div class="container">
    <div class="row">
      <div class="col-md-12 col-lg-3">
        <div class="content">
          <div class="brand">
            <img src="/assets/shared/dart/logo+text/horizontal/mono-004b4974b3112e2d9136b1c457037dfd9fe54e2e69e850d777891e5c2a57a78d.svg" alt="Dart logo" class="brand"/>
          </div>
          <h4><a href="/terms">Terms</a> | <a href="https://policies.google.com/privacy">Privacy</a></h4>
          <style>.menu .material-icons { font-size: 14px; }</style><ul class="menu">
            <li>Site&nbsp;<a href="http://creativecommons.org/licenses/by/3.0/" class="no-automatic-external">CC&nbsp;BY&nbsp;3.0</a></li>
            <li>
              <a href="https://github.com/dartchina/site-www-cn"
                 title="This site's source is on GitHub."
                 class="no-automatic-external"><i class="fab fa-github fa-sm"></i></a>
              &nbsp;
              <a href="https://github.com/dartchina/site-www-cn/issues"
                 title="File an issue about this site."
                 class="no-automatic-external"><i class="fas fa-bug fa-sm"></i></a>
              &nbsp;
              <a 
                 title="Site built on 2019/03/08 21:46 PST"
                 
                 class="no-automatic-external"><i class="material-icons">build</i></a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-md-4 col-lg-3">
        <div class="content">
          <h4>技术</h4>
          <ul>
            <li><a href="https://flutterchina.club">Dart 移动开发 (Flutter)</a></li>
            <li><a href="https://webdev.dartlang.org">Dart web 开发</a></li>
            <li><a href="/server">Dart 服务器开发</a></li>
            <li><a href="https://dart-lang.github.io/observatory/">Observatory 工具</a></li>
            <li><a href="/guides/libraries">Dart 库</a></li>
            <li><a href="/guides/language">Dart 编程语言</a></li>
          </ul>
        </div>
      </div>

      <div class="col-md-4 col-lg-3">
        <div class="content">
          <h4>资源</h4>
          <ul>
            <li><a href="https://api.dartlang.org/stable">API 参考</a></li>
            <li><a href="https://dartpad.dartlang.org/">DartPad</a></li>
            <li><a href="https://pub.dartlang.org/">Pub packages</a></li>
            <li><a href="http://news.dartlang.org/">Dart 新闻</a></li>
            <li><a href="https://github.com/dart-lang/sdk/issues">Dart bugs 和 <br> 新需求</a></li>
          </ul>
        </div>
      </div>

      <div class="col-md-4 col-lg-3">
        <div class="content">
          <h4>社区</h4>
          <ul>
            <li><a href="/community">支持和邮件列表</a></li>
            <li><a href="/community/who-uses-dart">谁在用Dart</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/dart">Stack Overflow</a></li>
            <li>G+ <a href="https://plus.google.com/communities/114566943291919232850">社区</a> &
                <a href="https://plus.google.com/b/109866369054280216564/+dartlang">公告组</a></li>
            <li><a href="https://gitter.im/dart-lang/home">Gitter聊天室</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

  </body>
</html>
